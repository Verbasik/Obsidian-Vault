## Суть

**Ранг матрицы** $\mathrm{rank}(A)$ — это максимальное число линейно независимых столбцов (или строк) матрицы $A$. Эквивалентно, это размерность векторного подпространства, порождаемого столбцами матрицы.

Ранг — одна из важнейших характеристик матрицы, которая определяет размерность образа линейного отображения, критерий совместности систем линейных уравнений и обратимость матрицы. В машинном обучении ранг связан с эффективной размерностью данных.

---

## Детали

### Определения (эквивалентные)

Для матрицы $A \in \mathbb{R}^{m \times n}$:

1. **Через столбцы**: $\mathrm{rank}(A)$ — максимальное число линейно независимых столбцов;

2. **Через строки**: $\mathrm{rank}(A)$ — максимальное число линейно независимых строк;

3. **Через подпространства**: $\mathrm{rank}(A) = \dim(\mathrm{Im}(A))$, где $\mathrm{Im}(A)$ — образ матрицы (пространство, порождаемое столбцами);

4. **Через ступенчатую форму**: $\mathrm{rank}(A)$ — число ненулевых строк в REF (ступенчатой форме).

### Фундаментальный факт

**Ранг по столбцам = Ранг по строкам**

Хотя это не очевидно, но максимальное число линейно независимых столбцов всегда равно максимальному числу линейно независимых строк.

### Свойства ранга

1. **Ограничения**:
   $$
   0 \le \mathrm{rank}(A) \le \min(m, n)
   $$
   для $A \in \mathbb{R}^{m \times n}$

2. **Полный ранг**: матрица имеет полный ранг, если $\mathrm{rank}(A) = \min(m, n)$

- Если $m \le n$: полный ранг строк;
- Если $m \ge n$: полный ранг столбцов.

3. **Обратимость**: квадратная матрица $A \in \mathbb{R}^{n \times n}$ обратима тогда и только тогда, когда:
   $$
   \mathrm{rank}(A) = n
   $$
4. **Транспонирование**:
   $$
   \mathrm{rank}(A) = \mathrm{rank}(A^\top)
   $$

5. **Умножение на обратимую матрицу**: если $B$ обратима, то:
   $$
   \mathrm{rank}(BA) = \mathrm{rank}(A) = \mathrm{rank}(AB)
   $$

6. **Неравенство Сильвестра** (ранг произведения):
   $$
   \mathrm{rank}(AB) \le \min(\mathrm{rank}(A), \mathrm{rank}(B))
   $$

7. **Ранг суммы**:
   $$
   \mathrm{rank}(A + B) \le \mathrm{rank}(A) + \mathrm{rank}(B)
   $$

8. **Элементарные преобразования** не меняют ранг матрицы

### Вычисление ранга

**Метод 1**: Привести матрицу к ступенчатой форме (REF) методом Гаусса и посчитать ненулевые строки.

**Метод 2**: Найти максимальный минор матрицы, определитель которого ненулевой.

**Метод 3**: Использовать SVD-разложение и посчитать ненулевые сингулярные числа.

### Связь с совместностью систем

Система $Ax = b$ совместна тогда и только тогда, когда:

$$
\mathrm{rank}(A) = \mathrm{rank}([A \mid b])
$$

где $[A \mid b]$ — расширенная матрица.

### Размерность пространства решений

Для совместной системы $Ax = b$, где $A \in \mathbb{R}^{m \times n}$, размерность пространства решений однородной системы $Ax = \mathbf{0}$:

$$
\dim(\mathrm{Ker}(A)) = n - \mathrm{rank}(A)
$$

Это число **свободных переменных** в системе.

---

## Примеры

### Единичная матрица

$$
I_n =
\begin{bmatrix}
1 & 0 & \cdots & 0 \cr
0 & 1 & \cdots & 0 \cr
\vdots & \vdots & \ddots & \vdots \cr
0 & 0 & \cdots & 1
\end{bmatrix}
$$

$\mathrm{rank}(I_n) = n$ (полный ранг)

### Вырожденная матрица

$$
A =
\begin{bmatrix}
1 & 2 \cr
2 & 4
\end{bmatrix}
$$

Второй столбец:
$$
\begin{bmatrix}
2 \cr
4
\end{bmatrix}
=
2
\begin{bmatrix}
1 \cr
2
\end{bmatrix}
$$

Следовательно, $\mathrm{rank}(A) = 1 < 2$. Матрица необратима.

### Вычисление через REF

$$
A =
\begin{bmatrix}
1 & 2 & 3 \cr
2 & 4 & 6 \cr
1 & 1 & 1
\end{bmatrix}
\xRightarrow{\text{REF}}
\begin{bmatrix}
1 & 2 & 3 \cr
0 & -2 & -4 \cr
0 & 0 & 0
\end{bmatrix}
$$

Две ненулевые строки → $\mathrm{rank}(A) = 2$

### Применение к совместности

Система:
$$
\begin{bmatrix}
1 & 2 \cr
2 & 4
\end{bmatrix}
\begin{bmatrix}
x_1 \cr
x_2
\end{bmatrix}
=
\begin{bmatrix}
3 \cr
6
\end{bmatrix}
$$

$\mathrm{rank}(A) = 1$

$$
[A \mid b] =
\begin{bmatrix}
1 & 2 & 3 \cr
2 & 4 & 6
\end{bmatrix},
\quad
\mathrm{rank}([A \mid b]) = 1
$$

Система совместна (т.к. ранги равны), но имеет бесконечно много решений (свободная переменная: $2 - 1 = 1$).

### Низкоранговая аппроксимация в ML

В PCA (анализе главных компонент) данные проецируются на подпространство меньшей размерности. Это эквивалентно аппроксимации исходной матрицы данных матрицей меньшего ранга.

---

## Источник

- Документ: [[Математика в машинном обучении.pdf]]
- Раздел/страницы: раздел 2.6.2, стр. 72–75 (ориентировочно)
- Ключевые определения: ранг через линейную независимость, связь с размерностью образа

---

## Вопросы

- Почему ранг по столбцам всегда равен рангу по строкам?
- Как быстро вычислить ранг большой разреженной матрицы?
- Как ранг связан с числом обусловленности матрицы?
- В каких задачах машинного обучения важна низкоранговая структура данных?
- Как численно устойчиво определить ранг при наличии погрешностей округления?