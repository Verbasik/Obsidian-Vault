## Суть

**Матричная форма шага исключения** — это представление элементарного преобразования строк как умножения на элементарную матрицу слева. Каждый шаг метода Гаусса, который раньше описывался словами («вычесть из $i$-й строки $j$-ю, умноженную на $l_{ij}$»), теперь записывается как матричное умножение $EA$.

Это ключевая идея связи между алгоритмическим и алгебраическим взглядом на исключение: **операции над строками = умножение на матрицы слева**.

---

## Детали

### Основная идея

Вместо описания словами:
> «Вычесть из второй строки первую, умноженную на 2»

Записываем матричное уравнение:
$$
E_{21} A = A'
$$

где $E_{21}$ — элементарная матрица, $A'$ — результат после преобразования.

### Общая формула

Для исключения элемента в позиции $(i, j)$ с помощью строки $j$ (при $i > j$):

$$
E_{ij} A = A^{(новая)}
$$

где:
$$
E_{ij} = I - l_{ij} \mathbf{e}_i \mathbf{e}_j^{\top}
$$

здесь $\mathbf{e}_i$ — $i$-й стандартный базисный вектор, $l_{ij} = \frac{a_{ij}}{a_{jj}}$ — множитель исключения.

### Последовательность шагов

Полный прямой ход метода Гаусса для системы $n \times n$:

$$
E_{n,n-1} \cdots E_{32} E_{31} E_{21} A = U
$$

или компактно:
$$
E A = U
$$

где $E = E_{n,n-1} \cdots E_{32} E_{31} E_{21}$ — произведение всех элементарных матриц.

### Связь с системой уравнений

Для системы $Ax = b$, применяя те же преобразования к правой части:

$$
E A x = E b
$$
$$
U x = c
$$

где $c = Eb$ — преобразованная правая часть.

**Ключевое наблюдение**: одинаковые преобразования применяются и к матрице, и к вектору.

### Эквивалентность преобразования

Матричная запись показывает, что преобразованная система **эквивалентна** исходной:

$$
Ax = b \quad \Leftrightarrow \quad Ux = c
$$

так как умножение на обратимую матрицу $E$ не меняет множество решений.

---

## Примеры

### Пример из книги: первый шаг

Исходная матрица:
$$
A = \begin{bmatrix}
2 & 1 & 1 \\
4 & 1 & 0 \\
-2 & 2 & 1
\end{bmatrix}
$$

**Шаг 1**: Исключить элемент $a_{21} = 4$ с помощью первой строки.

Множитель: $l_{21} = \frac{4}{2} = 2$

Элементарная матрица:
$$
E_{21} = \begin{bmatrix}
1 & 0 & 0 \\
-2 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
$$

**Матричная форма шага**:
$$
E_{21} A = \begin{bmatrix}
1 & 0 & 0 \\
-2 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
2 & 1 & 1 \\
4 & 1 & 0 \\
-2 & 2 & 1
\end{bmatrix}
= \begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
-2 & 2 & 1
\end{bmatrix}
$$

Элемент $a_{21}$ стал нулём ✓

### Второй и третий шаги

**Шаг 2**: Исключить $a_{31} = -2$.

$$
E_{31} = \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
1 & 0 & 1
\end{bmatrix}
$$

$$
E_{31}(E_{21} A) = \begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 3 & 2
\end{bmatrix}
$$

**Шаг 3**: Исключить новый элемент в позиции $(3,2)$.

$$
E_{32} = \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & -3 & 1
\end{bmatrix}
$$

$$
E_{32} E_{31} E_{21} A = \begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 0 & -4
\end{bmatrix} = U
$$

### Преобразование правой части

Для $b = \begin{bmatrix} 1 \\ -2 \\ 7 \end{bmatrix}$:

$$
c = E_{32} E_{31} E_{21} b
$$

**Шаг за шагом**:

После $E_{21}$:
$$
E_{21} b = \begin{bmatrix}
1 & 0 & 0 \\
-2 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix} 1 \\ -2 \\ 7 \end{bmatrix}
= \begin{bmatrix} 1 \\ -4 \\ 7 \end{bmatrix}
$$

После $E_{31}$:
$$
E_{31}(E_{21} b) = \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
1 & 0 & 1
\end{bmatrix}
\begin{bmatrix} 1 \\ -4 \\ 7 \end{bmatrix}
= \begin{bmatrix} 1 \\ -4 \\ 8 \end{bmatrix}
$$

После $E_{32}$:
$$
E_{32} E_{31} E_{21} b = \begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & -3 & 1
\end{bmatrix}
\begin{bmatrix} 1 \\ -4 \\ 8 \end{bmatrix}
= \begin{bmatrix} 1 \\ -4 \\ -4 \end{bmatrix} = c
$$

Система стала: $Ux = c$, где $U$ и $c$ получены выше.

### Визуализация процесса
```
Исходная:     Шаг 1:        Шаг 2:        Шаг 3:
   A             E₂₁A          E₃₁E₂₁A       E₃₂E₃₁E₂₁A = U
[2  1  1]     [2  1  1]     [2  1  1]     [2  1  1]
[4  1  0]  →  [0 -1 -2]  →  [0 -1 -2]  →  [0 -1 -2]
[-2 2  1]     [-2 2  1]     [0  3  2]     [0  0 -4]
```

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.4, стр. 30–32
- Ключевая цитата:
  
  > «Умножение на матрицу $E$ слева... выполняет тот же шаг исключения, который мы ранее описывали словами... Операция (4) является основополагающей для умножения матриц. Исходными величинами для неё являются вектор-строка и вектор-столбец одинаковой длины, а результатом — обычное число».

---

## Вопросы

- Как изменится матричная форма при перестановке строк?
- Можно ли представить все элементарные преобразования (включая умножение строки на константу) через матрицы?
- Почему порядок умножения элементарных матриц важен (некоммутативность)?
- Как матричная форма обобщается на блочные исключения?
- Можно ли использовать матричную форму для параллельного выполнения шагов исключения?