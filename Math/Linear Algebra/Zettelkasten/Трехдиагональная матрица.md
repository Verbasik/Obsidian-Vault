## Суть

**Трехдиагональная матрица** — это ленточная матрица с шириной ленты $w = 1$, у которой все ненулевые элементы расположены на главной диагонали и двух соседних диагоналях. Это наиболее важный класс ленточных матриц, возникающий при дискретизации обыкновенных дифференциальных уравнений второго порядка. Для трехдиагональных матриц метод исключения Гаусса имеет линейную сложность $O(n)$.

$$
A = \begin{bmatrix} 
d_1 & u_1 & 0 & \cdots & 0 \\
l_1 & d_2 & u_2 & \cdots & 0 \\
0 & l_2 & d_3 & \ddots & \vdots \\
\vdots & \ddots & \ddots & \ddots & u_{n-1} \\
0 & \cdots & 0 & l_{n-1} & d_n
\end{bmatrix}
$$

---

## Детали

### Структура и параметры

Трехдиагональная матрица $n \times n$ полностью определяется тремя векторами:
- **Главная диагональ:** $d_1, d_2, \ldots, d_n$ (n элементов);
- **Нижняя диагональ:** $l_1, l_2, \ldots, l_{n-1}$ (n-1 элементов);
- **Верхняя диагональ:** $u_1, u_2, \ldots, u_{n-1}$ (n-1 элементов).

Всего $3n - 2$ элементов вместо $n^2$ для плотной матрицы.

**Условие ленточности:**
$$
a_{ij} = 0 \quad \text{для} \quad |i - j| > 1
$$

### Возникновение при дискретизации

При дискретизации дифференциального уравнения $-\frac{d^2u}{dx^2} = f(x)$ разностной схемой:

$$
-u_{j+1} + 2u_j - u_{j-1} = h^2 f(jh)
$$

получается трехдиагональная матрица с:
- Главной диагональю: $d_i = 2$;
- Боковыми диагоналями: $l_i = u_i = -1$.

Это **симметрическая положительно определенная** трехдиагональная матрица.

### Эффективность метода исключения

Для трехдиагональной матрицы:

1. **Прямой ход (исключение):** На каждом шаге $j$ обнуляется только один элемент $l_j$ под ведущим. Требуется одно деление (для нахождения множителя $l_j/d_j$) и одно умножение-вычитание. Всего $\approx 2n$ операций.

2. **Обратная подстановка:** Также $\approx n$ операций.

**Общая сложность:** $P \approx 3n$ операций — **линейная зависимость от размера**!

Сравните с $P \approx \frac{n^3}{3}$ для плотных матриц.

### Сохранение структуры

**Важное свойство:** В процессе исключения Гаусса трехдиагональная матрица **остается трехдиагональной**. Не появляются ненулевые элементы вне трех диагоналей (заполнение отсутствует).

Это следует из того, что при обнулении $a_{j+1,j}$ изменяются только элементы $(j+1)$-й строки с индексами $j$ и $j+1$, которые уже лежат в пределах ленты.

---

## Примеры

**Пример 1: Стандартная трехдиагональная матрица из дискретизации**

$$
A = \begin{bmatrix} 
2 & -1 & 0 & 0 & 0 \\
-1 & 2 & -1 & 0 & 0 \\
0 & -1 & 2 & -1 & 0 \\
0 & 0 & -1 & 2 & -1 \\
0 & 0 & 0 & -1 & 2
\end{bmatrix}
$$

Главная диагональ: все элементы равны 2

Боковые диагонали: все элементы равны -1


**Пример 2: LDU-разложение трехдиагональной матрицы**

Из примера на стр. 57:

$$
L = \begin{bmatrix} 
1 & 0 & 0 & 0 & 0 \\
-\frac{1}{2} & 1 & 0 & 0 & 0 \\
0 & -\frac{2}{3} & 1 & 0 & 0 \\
0 & 0 & -\frac{3}{4} & 1 & 0 \\
0 & 0 & 0 & -\frac{4}{5} & 1
\end{bmatrix}, \quad
D = \begin{bmatrix} 
2 & 0 & 0 & 0 & 0 \\
0 & \frac{3}{2} & 0 & 0 & 0 \\
0 & 0 & \frac{4}{3} & 0 & 0 \\
0 & 0 & 0 & \frac{5}{4} & 0 \\
0 & 0 & 0 & 0 & \frac{6}{5}
\end{bmatrix}
$$

$$
U = \begin{bmatrix} 
1 & -\frac{1}{2} & 0 & 0 & 0 \\
0 & 1 & -\frac{2}{3} & 0 & 0 \\
0 & 0 & 1 & -\frac{3}{4} & 0 \\
0 & 0 & 0 & 1 & -\frac{4}{5} \\
0 & 0 & 0 & 0 & 1
\end{bmatrix}
$$

Заметьте: $L$ и $U$ — **двухдиагональные** (только главная + одна боковая).


**Пример 3: Первый шаг исключения**

Исходная матрица:
$$
\begin{bmatrix} 
2 & -1 & 0 \\
-1 & 2 & -1 \\
0 & -1 & 2
\end{bmatrix}
$$

Множитель: $l_{21} = \frac{-1}{2} = -\frac{1}{2}$

После обнуления $a_{21}$:
$$
\begin{bmatrix} 
2 & -1 & 0 \\
0 & \frac{3}{2} & -1 \\
0 & -1 & 2
\end{bmatrix}
$$

Структура сохранилась!


**Пример 4: Несимметричная трехдиагональная матрица**

$$
B = \begin{bmatrix} 
3 & 1 & 0 & 0 \\
-2 & 4 & 2 & 0 \\
0 & -1 & 5 & 3 \\
0 & 0 & -2 & 6
\end{bmatrix}
$$

Верхняя диагональ: $[1, 2, 3]$

Нижняя диагональ: $[-2, -1, -2]$

Не симметрична, но всё равно трехдиагональна.


**Пример 5: Решение системы $Ax = b$**

$$
A = \begin{bmatrix} 
2 & -1 & 0 \\
-1 & 2 & -1 \\
0 & -1 & 2
\end{bmatrix}, \quad
b = \begin{bmatrix} 
1 \\
0 \\
1
\end{bmatrix}
$$

**Прямой ход:**

Шаг 1: $l_{21} = -1/2$, $a'_{22} = 2 - (-1/2)(-1) = 3/2$, $b'_2 = 0 - (-1/2)(1) = 1/2$

Шаг 2: $l_{32} = -1/(3/2) = -2/3$, $a'_{33} = 2 - (-2/3)(-1) = 4/3$, $b'_3 = 1 - (-2/3)(1/2) = 4/3$

**Обратная подстановка:**

$x_3 = (4/3)/(4/3) = 1$

$x_2 = (1/2 - (-1)(1))/(3/2) = (3/2)/(3/2) = 1$

$x_1 = (1 - (-1)(1))/2 = 2/2 = 1$

Решение: $x = [1, 1, 1]^{\mathrm{T}}$


**Пример 6: Определитель трехдиагональной матрицы**

Для матрицы из примера 1:

$$
\det(A) = d_1 \cdot d_2 \cdot d_3 \cdot d_4 \cdot d_5 = 2 \cdot \frac{3}{2} \cdot \frac{4}{3} \cdot \frac{5}{4} \cdot \frac{6}{5} = 6
$$

Произведение диагональных элементов $D$ из LDU-разложения.


**Пример 7: Вычислительное сравнение**

Для $n = 10000$:

| Тип матрицы | Операции | Время (условно) |
|-------------|----------|-----------------|
| Трехдиагональная | $3 \times 10^4$ | 0.03 сек |
| Плотная | $3.3 \times 10^{11}$ | 3300 сек ≈ 1 час |

Ускорение в **11 миллионов раз**!


**Пример 8: Трехдиагональная матрица с нулевым ведущим элементом**

$$
C = \begin{bmatrix} 
0 & 1 & 0 \\
1 & 2 & -1 \\
0 & -1 & 2
\end{bmatrix}
$$

Первый ведущий элемент равен нулю. Требуется перестановка первой и второй строк:

$$
PC = \begin{bmatrix} 
1 & 2 & -1 \\
0 & 1 & 0 \\
0 & -1 & 2
\end{bmatrix}
$$

После перестановки матрица **перестает быть строго трехдиагональной** (появился элемент $a_{12} = 2$ вместо ожидаемой структуры).

---

## Источник

- Документ: [[Линейная_алгебра_и_её_применения.pdf]]
- Раздел/страницы: § 1.6, стр. 54, 56-58
- Ключевая цитата:
  
  > «Она является **трехдиагональной**. Все ее ненулевые элементы лежат на главной диагонали и на двух прилегающих к ней диагоналях... При сравнению с матрицей общего вида порядок пять здесь имеется два основных упрощения. (а) Ниже ведущего элемента был **только один ненулевой элемент**, а в общем случае кратное первой строки нужно вычитать из каждой другой строки; (б) Эта одна операция исключения была выполнена с очень короткими строками... трехдиагональная структура матрицы сохраняется в течение процесса исключения (при отсутствии перестановки строк!).»

---

## Вопросы

- Всегда ли трехдиагональная симметрическая матрица положительно определена?
- Как найти собственные значения трехдиагональной матрицы эффективно?
- Существуют ли прямые формулы для обратной трехдиагональной матрицы?
- Можно ли применить FFT для решения трехдиагональных систем?
- Как обобщается трехдиагональная структура на блочный случай?