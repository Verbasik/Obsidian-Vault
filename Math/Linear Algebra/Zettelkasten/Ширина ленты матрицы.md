## Суть

**Ширина ленты матрицы** $w$ — это параметр, характеризующий максимальное расстояние ненулевых элементов от главной диагонали. Матрица имеет ширину ленты $w$, если $a_{ij} = 0$ для всех пар индексов, удовлетворяющих $|i - j| > w$. Этот параметр критически важен для оценки вычислительной сложности метода исключения Гаусса: чем меньше $w$, тем эффективнее решение системы.

$$
w = \max\{|i - j| : a_{ij} \neq 0\}
$$

---

## Детали

### Определение и примеры значений

Для матрицы $A$ размера $n \times n$ ширина ленты $w$ определяется как максимальное из расстояний $|i - j|$ для всех ненулевых элементов $a_{ij}$.

**Классификация по ширине:**
- $w = 0$: диагональная матрица;
- $w = 1$: трехдиагональная матрица (три диагонали);
- $w = 2$: пятидиагональная матрица (пять диагоналей);
- $w = n - 1$: плотная матрица (все элементы могут быть ненулевыми).

**Число ненулевых диагоналей:** $2w + 1$ (главная + $w$ сверху + $w$ снизу).

### Связь с вычислительной сложностью

Ширина ленты напрямую определяет эффективность метода исключения Гаусса. Число операций пропорционально $w^2 n$, а не $n^3$ как для плотных матриц.

**Формула операций для ленточной матрицы** (стр. 57):

$$
P \approx \frac{1}{3}w(w-1)(3n - 2w + 1)
$$

При $w \ll n$:

$$
P \approx w^2 n
$$

**Частные случаи:**
- Трехдиагональная ($w = 1$): $P \approx n$ операций (линейная сложность!);
- Плотная ($w = n$): $P \approx \frac{1}{3}n(n-1)(n+1) \approx \frac{n^3}{3}$ (кубическая сложность).

### Сохранение ширины при исключении

**Критическое свойство:** Ширина ленты ленточной матрицы **сохраняется** в процессе исключения Гаусса (при отсутствии перестановок строк). Если исходная матрица $A$ имеет ширину $w$, то и верхняя треугольная матрица $U$ имеет ту же ширину $w$.

Это означает, что в процессе исключения:
1. Не требуется вычислять элементы вне ленты (они остаются нулевыми);
2. Множители $L$ также имеют ленточную структуру с шириной $w$;
3. Объем вычислений определяется шириной исходной матрицы.

---

## Примеры

**Пример 1: Трехдиагональная матрица ($w = 1$)**

$$
A = \begin{bmatrix} 
2 & -1 & 0 & 0 & 0 \\
-1 & 2 & -1 & 0 & 0 \\
0 & -1 & 2 & -1 & 0 \\
0 & 0 & -1 & 2 & -1 \\
0 & 0 & 0 & -1 & 2
\end{bmatrix}
$$

Ненулевые элементы: $a_{ii}$, $a_{i,i-1}$, $a_{i,i+1}$

Максимальное расстояние: $|i - (i \pm 1)| = 1$

**Ширина ленты: $w = 1$**.


**Пример 2: Пятидиагональная матрица ($w = 2$)**

$$
B = \begin{bmatrix} 
5 & 1 & 2 & 0 & 0 \\
1 & 5 & 1 & 2 & 0 \\
2 & 1 & 5 & 1 & 2 \\
0 & 2 & 1 & 5 & 1 \\
0 & 0 & 2 & 1 & 5
\end{bmatrix}
$$

Максимальное расстояние: $|1 - 3| = 2$ (элемент $b_{13} = 2$)

**Ширина ленты: $w = 2$**.


**Пример 3: Сравнение числа операций**

Для системы размером $n = 1000$:

| Тип матрицы | $w$ | Число операций $P$ | Относительная сложность |
|-------------|-----|-------------------|------------------------|
| Трехдиагональная | 1 | $\approx 1000$ | 1 |
| Пятидиагональная | 2 | $\approx 4000$ | 4 |
| Ширина 10 | 10 | $\approx 100000$ | 100 |
| Плотная | 1000 | $\approx 3.3 \times 10^8$ | 330000 |

**Вывод:** Малая ширина ленты дает огромное ускорение!


**Пример 4: Расчет по формуле для $w = 1$, $n = 5$**

$$
P = \frac{1}{3} \cdot 1 \cdot (1-1) \cdot (3 \cdot 5 - 2 \cdot 1 + 1) = \frac{1}{3} \cdot 1 \cdot 0 \cdot 14 = 0
$$

Формула дает 0, но на самом деле требуется $\approx 2n$ операций. При $w = 1$ формула неточна, так как умножение на $(w-1)$ дает ноль. Более точная оценка для трехдиагональных: $P \approx 2n$.


**Пример 5: Расчет для $w = 2$, $n = 100$**

$$
P = \frac{1}{3} \cdot 2 \cdot (2-1) \cdot (3 \cdot 100 - 2 \cdot 2 + 1) = \frac{1}{3} \cdot 2 \cdot 1 \cdot 297 = \frac{594}{3} = 198
$$

Примерно **200 операций** вместо $\frac{100^3}{3} \approx 333000$ для плотной матрицы — выигрыш в **1665 раз**!


**Пример 6: Влияние перестановки строк**

Рассмотрим трехдиагональную матрицу:

$$
A = \begin{bmatrix} 
0 & 1 & 0 \\
1 & 2 & -1 \\
0 & -1 & 2
\end{bmatrix}
$$

Ширина $w = 1$. После перестановки первой и второй строк:

$$
PA = \begin{bmatrix} 
1 & 2 & -1 \\
0 & 1 & 0 \\
0 & -1 & 2
\end{bmatrix}
$$

Ширина всё ещё $w = 1$ — структура сохранилась.


**Пример 7: Неудачная нумерация узлов в 2D**

При дискретизации уравнения Лапласа на сетке $m \times m$ стандартная нумерация узлов по строкам даёт ширину ленты $w \approx m$ для матрицы размером $n = m^2 \times m^2$.

Альтернативная нумерация (например, шахматная) может уменьшить $w$ и ускорить вычисления.


**Пример 8: Визуализация ленты для разных $w$**

Для $n = 7$:

**$w = 1$ (трехдиагональная):**
```
× ×
× × ×
  × × ×
    × × ×
      × × ×
        × × ×
          × ×
```

**$w = 2$ (пятидиагональная):**
```
× × ×
× × × ×
× × × × ×
  × × × × ×
    × × × × ×
      × × × ×
        × × ×
```

Площадь ненулевых элементов растёт как $w^2$.

---

## Источник

- Документ: [[Линейная_алгебра_и_её_применения.pdf]]
- Раздел/страницы: § 1.6, стр. 54, 57-58
- Ключевая цитата:
  
  > «Рассмотрим более общий случай, когда $A$ — ленточная матрица, т. е. все ее ненулевые элементы лежат внутри полосы, располагающейся параллельно главной диагонали. **Ширина ленты** или, точнее говоря, **половина ширины ленты**, $w$ определяется следующим образом. Это такое наименьшее из целых чисел, что $a_{ij} = 0$ для всех $i, j$, таких, что $|i - j| > w$... **Ширина ленты становится меньше.** Точнее число делений и умножений-вычитаний, требуемых для построения $L$, $D$ и $U$ (без предположения симметричности $A$), вычисляется по формуле $P = \frac{1}{3}w(w-1)(3n - 2w + 1)$.»

---

## Вопросы

- Как оптимально нумеровать узлы в многомерных задачах для минимизации $w$?
- Существуют ли алгоритмы автоматического упорядочения для уменьшения ширины ленты?
- Как влияет выбор ведущего элемента на сохранение ширины ленты?
- Можно ли использовать разреженные форматы хранения для ленточных матриц?
- Какова связь между шириной ленты и числом обусловленности матрицы?