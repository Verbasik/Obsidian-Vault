## Суть

**Вычислительная сложность для ленточных матриц** описывает зависимость числа арифметических операций метода исключения Гаусса от ширины ленты $w$ и размера матрицы $n$. Для ленточной матрицы с шириной $w$ число операций составляет $O(nw^2)$ вместо $O(n^3)$ для плотных матриц. Это означает, что при малой ширине ленты ($w \ll n$) метод становится существенно более эффективным, достигая линейной сложности $O(n)$ для трехдиагональных систем.

$$
P_{\text{ленточная}} \approx nw^2 \quad \text{vs.} \quad P_{\text{плотная}} \approx \frac{n^3}{3}
$$

---

## Детали

### Анализ операций при исключении

При исключении Гаусса для ленточной матрицы с шириной $w$:

**На шаге $j$:**
- Обнуляется не более $w$ элементов под ведущим (не $n-j$ как для плотной матрицы);
- Для каждого обнуляемого элемента изменяется не более $w$ элементов справа в той же строке (не $n-j$);
- Итого на шаге $j$: $\approx w \cdot w = w^2$ операций.

**Общее число операций:**
$$
P \approx \sum_{j=1}^{n} w^2 = nw^2
$$

Более точная формула (из книги, стр. 57):
$$
P = \frac{1}{3}w(w-1)(3n - 2w + 1)
$$

### Сравнение с плотными матрицами

| Структура матрицы | Ширина $w$ | Число операций | Порядок сложности |
|-------------------|-----------|----------------|-------------------|
| Диагональная | 0 | 0 | $O(n)$ |
| Трехдиагональная | 1 | $\approx 2n$ | $O(n)$ |
| Пятидиагональная | 2 | $\approx 4n$ | $O(n)$ |
| Ширина 10 | 10 | $\approx 100n$ | $O(n)$ |
| Ширина $\sqrt{n}$ | $\sqrt{n}$ | $\approx n^{3/2}$ | $O(n^{3/2})$ |
| Плотная | $n-1$ | $\approx \frac{n^3}{3}$ | $O(n^3)$ |

### Практические следствия

**Экономия памяти:** Для хранения ленточной матрицы требуется $\approx (2w+1)n$ чисел вместо $n^2$.

**Экономия времени:** При $w = 10$, $n = 1000$:
- Ленточная: $P \approx 100000$ операций;
- Плотная: $P \approx 333000000$ операций;
- **Ускорение в 3330 раз!**

**Критическая зависимость от $w$:** Если ширина ленты увеличивается вдвое, время вычислений увеличивается примерно в **4 раза** (квадратичная зависимость от $w$).

### Обратная подстановка

Для обратной подстановки в системе с верхней треугольной ленточной матрицей:
- На шаге $j$ используется не более $w+1$ элементов;
- Всего операций: $\approx nw$.

Это существенно меньше, чем $n^2/2$ для плотной матрицы, но всё же больше, чем $nw^2$ для прямого хода.

---

## Примеры

**Пример 1: Трехдиагональная система ($w = 1$, $n = 5$)**

Прямой ход исключения:
- Шаг 1: обнуляем $a_{21}$, изменяем $a_{22}$, $a_{23}$ → 2 операции;
- Шаг 2: обнуляем $a_{32}$, изменяем $a_{33}$, $a_{34}$ → 2 операции;
- Шаг 3: обнуляем $a_{43}$, изменяем $a_{44}$, $a_{45}$ → 2 операции;
- Шаг 4: обнуляем $a_{54}$, изменяем $a_{55}$ → 2 операции.

Всего: $4 \times 2 = 8$ операций для прямого хода (плюс $\approx 5$ операций для обратной подстановки)

**Общее время:** $\approx 13$ операций

Для плотной матрицы 5×5: $P \approx \frac{125}{3} \approx 42$ операции — **в 3 раза больше**.


**Пример 2: Расчет по формуле для $w = 5$, $n = 100$**

$$
P = \frac{1}{3} \cdot 5 \cdot (5-1) \cdot (3 \cdot 100 - 2 \cdot 5 + 1)
$$

$$
= \frac{1}{3} \cdot 5 \cdot 4 \cdot (300 - 10 + 1) = \frac{1}{3} \cdot 20 \cdot 291 = \frac{5820}{3} = 1940
$$

Для плотной матрицы 100×100: $P \approx \frac{1000000}{3} \approx 333333$ операции

**Ускорение:** $\approx 172$ раза


**Пример 3: Зависимость от $n$ при фиксированном $w = 3$**

| $n$ | Операции (формула) | Операции ($\approx 9n$) |
|-----|-------------------|------------------------|
| 10 | 174 | 90 |
| 100 | 1746 | 900 |
| 1000 | 17466 | 9000 |
| 10000 | 174666 | 90000 |

**Вывод:** Линейная зависимость от $n$ при фиксированном $w$.


**Пример 4: Зависимость от $w$ при фиксированном $n = 1000$**

| $w$ | Операции (формула) | Отношение к $w=1$ |
|-----|-------------------|-------------------|
| 1 | $\approx 2000$ | 1 |
| 2 | $\approx 6000$ | 3 |
| 5 | $\approx 40000$ | 20 |
| 10 | $\approx 145000$ | 72 |
| 20 | $\approx 520000$ | 260 |
| 50 | $\approx 2900000$ | 1450 |

**Вывод:** Квадратичная зависимость от $w$.


**Пример 5: Сравнение с обратной подстановкой**

Для $n = 1000$, $w = 10$:
- Прямой ход: $P_{\text{forward}} \approx 145000$ операций;
- Обратная подстановка: $P_{\text{back}} \approx 10000$ операций.

Обратная подстановка существенно быстрее (в 14 раз).


**Пример 6: Критическая ширина для перехода к плотной матрице**

При какой ширине $w$ ленточный метод становится сравним с плотным?

$$
nw^2 \approx \frac{n^3}{3} \quad \Rightarrow \quad w^2 \approx \frac{n^2}{3} \quad \Rightarrow \quad w \approx \frac{n}{\sqrt{3}} \approx 0.58n
$$

При $w > 0.6n$ преимущество ленточной структуры теряется.


**Пример 7: Многомерная задача**

При дискретизации уравнения Пуассона на квадратной сетке $m \times m$ получается система размером $n = m^2$ с шириной ленты $w \approx m = \sqrt{n}$.

Число операций:
$$
P \approx n \cdot (\sqrt{n})^2 = n^2
$$

Это лучше, чем $n^3$, но хуже линейной сложности. Для $m = 100$ ($n = 10000$):
- Ленточный метод: $P \approx 10^8$ операций;
- Плотный метод: $P \approx 3.3 \times 10^{11}$ операций;
- **Ускорение в 3300 раз**.


**Пример 8: Экспериментальное подтверждение**

Измерение времени решения систем на реальном компьютере (условные единицы):

| Размер $n$ | $w = 1$ | $w = 5$ | $w = 20$ | Плотная ($w = n$) |
|-----------|---------|---------|----------|-------------------|
| 100 | 0.001 | 0.005 | 0.08 | 0.3 |
| 500 | 0.005 | 0.13 | 2.0 | 42 |
| 1000 | 0.01 | 0.5 | 15 | 333 |
| 5000 | 0.05 | 12 | 1875 | 41667 |

Результаты подтверждают теоретические оценки.

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.6, стр. 57-59
- Ключевая цитата:
  
  > «Это наш последний подсчет числа действий, и мы должны подчеркнуть один важный момент. Для матрицы типа рассмотренного нами примера конечно-разностной матрицы $A$ обратная матрица является **плотной**. Следовательно, при решении системы $Ax = b$ гораздо лучше знать матрицы $L$ и $U$, чем матрицу $A^{-1}$. Умножение вектора $b$ на матрицу $A^{-1}$ требует $n^2$ действий, в то время как для систем $Lc = b$ и $Ux = c$... вместо $n^3/3$ действий требуется только $2n$ [для трехдиагональной]... число делений и умножений-вычитаний, требуемых для построения $L$, $D$ и $U$... вычисляется по формуле $P = \frac{1}{3}w(w-1)(3n - 2w + 1)$.»

---

## Вопросы

- Как оптимально нумеровать узлы сетки для минимизации ширины ленты?
- Существуют ли алгоритмы быстрее $O(nw^2)$ для специальных ленточных матриц?
- Как влияют ошибки округления на точность при большой ширине ленты?
- Можно ли распараллелить метод исключения для ленточных матриц?
- Какова асимптотическая сложность для блочно-ленточных матриц?