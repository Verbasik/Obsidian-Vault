## Суть

**Ленточная матрица** — это матрица, все ненулевые элементы которой сосредоточены около главной диагонали в виде "ленты". Формально, матрица $A$ является ленточной с **шириной ленты** $w$, если $a_{ij} = 0$ для всех $|i - j| > w$. Все элементы, расположенные далее чем на $w$ диагоналей от главной, равны нулю. Ленточные матрицы часто возникают при дискретизации дифференциальных уравнений и позволяют значительно сократить вычислительные затраты при решении систем.

$$
\text{Ленточная матрица}: \quad a_{ij} = 0 \quad \text{для} \quad |i - j| > w
$$

---

## Детали

### Определение ширины ленты

**Ширина ленты** $w$ — это минимальное целое число такое, что все ненулевые элементы лежат в полосе шириной $2w + 1$ вокруг главной диагонали. Другими словами:

- На главной диагонали: $w = 0$;
- По $w$ диагоналей выше главной;
- По $w$ диагоналей ниже главной.

Конкретные значения:
- **Диагональная матрица**: $w = 0$ (только главная диагональ);
- **Трехдиагональная матрица**: $w = 1$ (главная + по одной диагонали с каждой стороны);
- **Пятидиагональная матрица**: $w = 2$;
- **Плотная матрица**: $w = n - 1$ (все элементы могут быть ненулевыми).

### Связь с дискретизацией

При дискретизации дифференциального уравнения второго порядка центральной разностной схемой получается **трехдиагональная** матрица ($w = 1$). Это связано с тем, что в разностную схему входят только три соседних узла: $u_{j-1}$, $u_j$, $u_{j+1}$.

Для уравнений четвертого порядка или многомерных задач ширина ленты увеличивается.

### Вычислительные преимущества

Ленточная структура матрицы $A$ обладает двумя важными свойствами, которые резко снижают вычислительные затраты:

1. **При исключении отсутствует необходимость в вычислении изменений, происходящих над главной диагональю** (стр. 54)

2. **Трехдиагональная структура матрицы сохраняется в течение процесса исключения** (при отсутствии перестановок строк)

Для ленточной матрицы с шириной $w$ число операций метода исключения составляет примерно $O(nw^2)$ вместо $O(n^3)$ для плотной матрицы. При $w \ll n$ это дает огромный выигрыш.

---

## Примеры

**Пример 1: Трехдиагональная матрица ($w = 1$)**

$$
A = \begin{bmatrix} 2 & -1 & 0 & 0 & 0 \\ -1 & 2 & -1 & 0 & 0 \\ 0 & -1 & 2 & -1 & 0 \\ 0 & 0 & -1 & 2 & -1 \\ 0 & 0 & 0 & -1 & 2 \end{bmatrix}
$$

Ненулевые элементы: главная диагональ и две соседние диагонали. $w = 1$.


**Пример 2: Пятидиагональная матрица ($w = 2$)**

$$
B = \begin{bmatrix} 
4 & -1 & 1 & 0 & 0 \\
-1 & 4 & -1 & 1 & 0 \\
1 & -1 & 4 & -1 & 1 \\
0 & 1 & -1 & 4 & -1 \\
0 & 0 & 1 & -1 & 4
\end{bmatrix}
$$

$w = 2$: две диагонали выше и две ниже главной.


**Пример 3: Диагональная матрица ($w = 0$)**

$$
D = \begin{bmatrix} 3 & 0 & 0 & 0 \\ 0 & 5 & 0 & 0 \\ 0 & 0 & 7 & 0 \\ 0 & 0 & 0 & 9 \end{bmatrix}
$$

Предельный случай ленточной матрицы: $w = 0$.


**Пример 4: LDU-разложение трехдиагональной матрицы**

Из примера на стр. 57:

$$
A = \begin{bmatrix} 
1 & 0 & 0 & 0 & 0 \\
-\frac{1}{2} & 1 & 0 & 0 & 0 \\
0 & -\frac{2}{3} & 1 & 0 & 0 \\
0 & 0 & -\frac{3}{4} & 1 & 0 \\
0 & 0 & 0 & -\frac{4}{5} & 1
\end{bmatrix}
\begin{bmatrix} 
\frac{2}{1} & 0 & 0 & 0 & 0 \\
0 & \frac{3}{2} & 0 & 0 & 0 \\
0 & 0 & \frac{4}{3} & 0 & 0 \\
0 & 0 & 0 & \frac{5}{4} & 0 \\
0 & 0 & 0 & 0 & \frac{6}{5}
\end{bmatrix}
\begin{bmatrix} 
1 & -\frac{1}{2} & 0 & 0 & 0 \\
0 & 1 & -\frac{2}{3} & 0 & 0 \\
0 & 0 & 1 & -\frac{3}{4} & 0 \\
0 & 0 & 0 & 1 & -\frac{4}{5} \\
0 & 0 & 0 & 0 & 1
\end{bmatrix}
$$

**Сомножители $L$ и $U$ разложения трехдиагональной матрицы являются двухдиагональными матрицами.**


**Пример 5: Визуализация ленточной структуры**

Для $n = 5$, $w = 1$ (рис. 1.2 на стр. 58):
```
A = [ × ×               ]
    [ × × ×             ]  = LU
    [   × × ×           ]
    [     × × ×         ]
    [       × × ×       ]
```

Здесь × обозначает ненулевой элемент.


**Пример 6: Ленточная матрица после первого шага исключения**

После исключения под первым ведущим элементом трехдиагональной матрицы:

$$
\begin{bmatrix} 
2 & -1 & 0 & 0 & 0 \\
-1 & 2 & -1 & 0 & 0 \\
0 & -1 & 2 & -1 & 0 \\
0 & 0 & -1 & 2 & -1 \\
0 & 0 & 0 & -1 & 2
\end{bmatrix}
\rightarrow
\begin{bmatrix} 
2 & -1 & 0 & 0 & 0 \\
0 & \frac{3}{2} & -1 & 0 & 0 \\
0 & -1 & 2 & -1 & 0 \\
0 & 0 & -1 & 2 & -1 \\
0 & 0 & 0 & -1 & 2
\end{bmatrix}
$$

**Структура сохраняется:** матрица остается трехдиагональной!


**Пример 7: Матрица с шириной ленты $w = n - 1$ (плотная)**

$$
C = \begin{bmatrix} 
1 & 2 & 3 & 4 \\
5 & 6 & 7 & 8 \\
9 & 10 & 11 & 12 \\
13 & 14 & 15 & 16
\end{bmatrix}
$$

Все элементы могут быть ненулевыми: $w = 3 = n - 1$.


**Пример 8: Подсчет числа ненулевых элементов**

Для ленточной матрицы $n \times n$ с шириной $w$:

- В центральных строках: $2w + 1$ ненулевых элементов;
- В первых/последних $w$ строках: меньше элементов.

Общее число ненулевых элементов $\approx (2w + 1)n - w(w+1)$ при $w \ll n$.

Для трехдиагональной ($w = 1$, $n = 5$): $3 \cdot 5 - 2 = 13$ ненулевых элементов вместо $25$.

---
## Инфографика:

![[Ленточная матрица.pdf]]

---
## Источник

- Документ: [[Линейная_алгебра_и_её_применения.pdf]]
- Раздел/страницы: § 1.6, стр. 53-54, 57-58
- Ключевая цитата:
  
  > «Матрица $A$ обладает еще двумя свойствами, которые мы не решаемся обсуждать здесь, но не потому, что они не важны, а именно из-за того, что они слишком важны... Одно из которых представляет для нас наибольший интерес: **она является трехдиагональной**. Все ее ненулевые элементы лежат на главной диагонали и на двух прилегающих к ней диагоналях. Иначе говоря, элементы матрицы равны нулю, если разность между номерами их строк и столбцов по модулю больше единицы, т. е. $a_{ij} = 0$ для всех $i, j$, таких, что $|i - j| > 1$.»

---
## Вопросы

- Почему ленточная структура сохраняется при исключении Гаусса?
- Какая будет ширина ленты при дискретизации уравнения Лапласа в 2D?
- Можно ли эффективно хранить ленточную матрицу в памяти?
- Как влияет перестановка строк на ширину ленты?
- Существуют ли специальные алгоритмы для ленточных матриц?