## Суть

**Разностная схема для второй производной** — это способ аппроксимации $\frac{d^2u}{dx^2}$ конечными разностями. Наиболее употребительная **центральная разностная схема второго порядка точности** имеет вид:

$$
\frac{d^2u}{dx^2}(x) \approx \frac{u(x+h) - 2u(x) + u(x-h)}{h^2}
$$

Эта формула позволяет заменить дифференциальное уравнение системой алгебраических уравнений и является основой дискретизации краевых задач.

---

## Детали

### Вывод формулы через разложение Тейлора

Разложим функцию $u(x)$ в ряд Тейлора в окрестности точки $x$:

$$
u(x+h) = u(x) + hu'(x) + \frac{h^2}{2}u''(x) + \frac{h^3}{6}u'''(x) + \frac{h^4}{24}u^{(4)}(x) + O(h^5)
$$

$$
u(x-h) = u(x) - hu'(x) + \frac{h^2}{2}u''(x) - \frac{h^3}{6}u'''(x) + \frac{h^4}{24}u^{(4)}(x) + O(h^5)
$$

Сложим эти два уравнения:

$$
u(x+h) + u(x-h) = 2u(x) + h^2u''(x) + \frac{h^4}{12}u^{(4)}(x) + O(h^6)
$$

Отсюда:

$$
u''(x) = \frac{u(x+h) - 2u(x) + u(x-h)}{h^2} - \frac{h^2}{12}u^{(4)}(x) + O(h^4)
$$

**Вывод:** Ошибка аппроксимации имеет порядок $O(h^2)$. Это означает, что при уменьшении шага $h$ в 2 раза ошибка уменьшается примерно в 4 раза.

### Три варианта аппроксимации первой производной

Для первой производной существуют три основных схемы (стр. 53):

1. **Правая разность:**
$$
\frac{du}{dx} \approx \frac{u(x+h) - u(x)}{h}
$$
Порядок точности: $O(h)$

2. **Левая разность:**
$$
\frac{du}{dx} \approx \frac{u(x) - u(x-h)}{h}
$$
Порядок точности: $O(h)$

3. **Центральная разность:**
$$
\frac{du}{dx} \approx \frac{u(x+h) - u(x-h)}{2h}
$$
Порядок точности: $O(h^2)$ — **самая точная!**

### Симметричность схемы

Центральная разностная схема для второй производной **симметрична** относительно $x$: она использует значения функции в точках $x-h$ и $x+h$ с одинаковыми весами. Это свойство приводит к тому, что матрица дискретной системы также симметрична.

---

## Примеры

**Пример 1: Проверка на параболе**

Пусть $u(x) = x^2$. Тогда $u''(x) = 2$ (точное значение).

Вычислим по формуле при $h = 0.1$, $x = 1$:

$$
\frac{u(1.1) - 2u(1) + u(0.9)}{(0.1)^2} = \frac{1.21 - 2 \cdot 1 + 0.81}{0.01} = \frac{0.02}{0.01} = 2
$$

Результат **точный**, так как $u^{(4)}(x) = 0$ для квадратичной функции!


**Пример 2: Проверка на кубической функции**

Пусть $u(x) = x^3$. Тогда $u''(x) = 6x$.

При $x = 1$, $h = 0.1$:

$$
\frac{(1.1)^3 - 2 \cdot 1^3 + (0.9)^3}{0.01} = \frac{1.331 - 2 + 0.729}{0.01} = \frac{0.06}{0.01} = 6
$$

Снова точное значение (так как $u^{(4)}(x) = 0$).


**Пример 3: Ошибка на функции $u(x) = \sin(x)$**

$u''(x) = -\sin(x)$

При $x = \pi/2$, $h = 0.01$:

$$
\frac{\sin(\pi/2 + 0.01) - 2\sin(\pi/2) + \sin(\pi/2 - 0.01)}{0.0001}
$$

$$
\approx \frac{0.99995 - 2 + 0.99995}{0.0001} \approx -1.0000
$$

Точное значение: $-\sin(\pi/2) = -1$. Ошибка $\sim 10^{-5} \sim h^2$.


**Пример 4: Сравнение односторонних и центральных разностей для $u'$**

Пусть $u(x) = e^x$, $x = 0$, $h = 0.1$. Точное значение: $u'(0) = 1$.

**Правая разность:**
$$
\frac{e^{0.1} - 1}{0.1} = \frac{1.10517 - 1}{0.1} = 1.0517 \quad (\text{ошибка } 5.17\%)
$$

**Центральная разность:**
$$
\frac{e^{0.1} - e^{-0.1}}{0.2} = \frac{1.10517 - 0.90484}{0.2} = 1.00167 \quad (\text{ошибка } 0.167\%)
$$

Центральная схема **в 30 раз точнее**!


**Пример 5: Дискретизация уравнения $-u'' = 1$**

$$
-\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} = 1
$$

$$
-u_{j+1} + 2u_j - u_{j-1} = h^2
$$

Это уравнение (29) из книги для $f(jh) = 1$.


**Пример 6: Структура трехточечного шаблона**

Разностная схема использует **шаблон из трех точек**: $x_{j-1}$, $x_j$, $x_{j+1}$.
```
    o-------o-------o
  x_{j-1}  x_j  x_{j+1}
    
  вес: +1   -2    +1
```

Это приводит к трехдиагональной матрице системы.


**Пример 7: Граничные точки**

При $j = 1$: используются $u_0$, $u_1$, $u_2$. Поскольку $u_0 = 0$ (краевое условие), получаем:

$$
-u_2 + 2u_1 - 0 = h^2f(h) \quad \Rightarrow \quad -u_2 + 2u_1 = h^2f(h)
$$


**Пример 8: Разности высших порядков**

Для четвертой производной $u^{(4)}$ можно использовать схему с 5 точками:

$$
\frac{d^4u}{dx^4} \approx \frac{u(x+2h) - 4u(x+h) + 6u(x) - 4u(x-h) + u(x-2h)}{h^4}
$$

---

## Источник

- Документ: [[Линейная_алгебра_и_её_применения.pdf]]
- Раздел/страницы: § 1.6, стр. 53
- Ключевая цитата:
  
  > «Для первой производной имеется три возможности: $\frac{du}{dx} \approx \frac{u(x+h) - u(x)}{h}, \quad \frac{du}{dx} \approx \frac{u(x) - u(x-h)}{h}, \quad \frac{du}{dx} \approx \frac{u(x+h) - u(x-h)}{2h}$. Оказывается, что последнее отношение, в силу своей симметрии относительно $x$, является самым лучшим. Для второй же производной существует единственная возможная комбинация, которая использует значения только в точках $x$ и $x \pm h$: $\frac{d^2u}{dx^2} \approx \frac{u(x+h) - 2u(x) + u(x-h)}{h^2}$.»

---

## Вопросы

- Почему центральная схема точнее односторонних?
- Можно ли построить схему третьего порядка точности для второй производной?
- Как влияет гладкость функции $u(x)$ на точность аппроксимации?
- Существуют ли разностные схемы для неравномерных сеток?
- Как обобщается схема на многомерный случай?