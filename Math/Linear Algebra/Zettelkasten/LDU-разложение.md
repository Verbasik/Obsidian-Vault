## Суть

**LDU-разложение** — это уточнённая форма LU-разложения, где верхняя треугольная матрица $U$ дополнительно разлагается на диагональную матрицу $D$ и верхнюю треугольную матрицу с **единицами на диагонали**:

$$
A = LDU
$$

где $L$ — нижняя треугольная с единицами на диагонали, $D$ — диагональная, $U$ — верхняя треугольная с единицами на диагонали.

Это разложение **симметрично** по структуре: $L$ и $U$ имеют одинаковую форму (единицы на диагонали), а вся информация о масштабе сосредоточена в диагональной матрице $D$.

---

## Детали

### Определение

**LDU-разложением** матрицы $A$ называется представление:

$$
A = LDU
$$

где:
- $L$ — **нижняя треугольная** с единицами на диагонали;
- $D$ — **диагональная** матрица;
- $U$ — **верхняя треугольная** с единицами на диагонали.

### Получение из LU-разложения

Если известно LU-разложение $A = L \tilde{U}$, где $\tilde{U}$ — обычная верхняя треугольная, то:

**Шаг 1**: Выделить диагональ из $\tilde{U}$:
$$
D = \begin{bmatrix}
\tilde{u}_{11} & 0 & \cdots & 0 \\
0 & \tilde{u}_{22} & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & \tilde{u}_{nn}
\end{bmatrix}
$$

**Шаг 2**: Нормализовать $\tilde{U}$:
$$
U = D^{-1} \tilde{U}
$$

Это даёт верхнюю треугольную матрицу с единицами на диагонали.

**Результат**: $A = L D U$, так как:
$$
A = L \tilde{U} = L (D U) = LDU
$$

### Элементы диагональной матрицы

Диагональные элементы $d_i$ — это **ведущие элементы** процесса исключения:

$$
D = \begin{bmatrix}
d_1 & 0 & \cdots & 0 \\
0 & d_2 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & d_n
\end{bmatrix}
$$

где $d_i$ — $i$-й ведущий элемент (pivot).

### Симметричный случай

Для **симметричной** матрицы $A = A^{\top}$, если существует LDU-разложение, то:

$$
A = LDL^{\top}
$$

т.е. $U = L^{\top}$.

**Доказательство**: Транспонируя $A = LDU$ и используя $A^{\top} = A$:
$$
A = A^{\top} = U^{\top} D L^{\top}
$$

По единственности разложения: $U^{\top} = L$ (с точностью до диагонали).

### Связь с определителем

Определитель легко вычисляется:
$$
\det(A) = \det(L) \cdot \det(D) \cdot \det(U) = 1 \cdot \det(D) \cdot 1 = \prod_{i=1}^n d_i
$$

Определитель — это **произведение ведущих элементов**.

---

## Примеры

### Пример из книги

Из LU-разложения:
$$
A = \begin{bmatrix}
1 & 0 & 0 \\
2 & 1 & 0 \\
-1 & -3 & 1
\end{bmatrix}
\begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 0 & -4
\end{bmatrix}
$$

**Выделяем диагональ**:
$$
D = \begin{bmatrix}
2 & 0 & 0 \\
0 & -1 & 0 \\
0 & 0 & -4
\end{bmatrix}
$$

**Нормализуем верхнюю треугольную**:
$$
U = D^{-1} \tilde{U} = \begin{bmatrix}
\frac{1}{2} & 0 & 0 \\
0 & -1 & 0 \\
0 & 0 & -\frac{1}{4}
\end{bmatrix}
\begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 0 & -4
\end{bmatrix}
= \begin{bmatrix}
1 & \frac{1}{2} & \frac{1}{2} \\
0 & 1 & 2 \\
0 & 0 & 1
\end{bmatrix}
$$

**LDU-разложение**:
$$
A = \begin{bmatrix}
1 & 0 & 0 \\
2 & 1 & 0 \\
-1 & -3 & 1
\end{bmatrix}
\begin{bmatrix}
2 & 0 & 0 \\
0 & -1 & 0 \\
0 & 0 & -4
\end{bmatrix}
\begin{bmatrix}
1 & \frac{1}{2} & \frac{1}{2} \\
0 & 1 & 2 \\
0 & 0 & 1
\end{bmatrix}
$$

### Симметричная матрица

$$
A = \begin{bmatrix}
4 & 2 \\
2 & 3
\end{bmatrix}
$$

**Исключение**: $l_{21} = \frac{2}{4} = \frac{1}{2}$

$$
L = \begin{bmatrix} 1 & 0 \\ \frac{1}{2} & 1 \end{bmatrix}, \quad
\tilde{U} = \begin{bmatrix} 4 & 2 \\ 0 & 2 \end{bmatrix}
$$

**LDU**:
$$
D = \begin{bmatrix} 4 & 0 \\ 0 & 2 \end{bmatrix}, \quad
U = \begin{bmatrix} 1 & \frac{1}{2} \\ 0 & 1 \end{bmatrix}
$$

Проверим симметрию: $U = L^{\top}$?
$$
L^{\top} = \begin{bmatrix} 1 & \frac{1}{2} \\ 0 & 1 \end{bmatrix} = U \quad \checkmark
$$

Значит:
$$
A = LDL^{\top} = \begin{bmatrix} 1 & 0 \\ \frac{1}{2} & 1 \end{bmatrix}
\begin{bmatrix} 4 & 0 \\ 0 & 2 \end{bmatrix}
\begin{bmatrix} 1 & \frac{1}{2} \\ 0 & 1 \end{bmatrix}
$$

### Вычисление определителя

Для матрицы из первого примера:
$$
\det(A) = d_1 \cdot d_2 \cdot d_3 = 2 \cdot (-1) \cdot (-4) = 8
$$

Проверка прямым вычислением определителя $A$ подтверждает результат.

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.4, стр. 36–37
- Ключевая цитата:
  
  > «В одном отношении $LU$-разложение 'несимметрично': на главной диагонали матрицы $U$ расположены ведущие элементы $d_1, \ldots, d_n$, в то время как в $L$ на этих местах стоят единицы... Эту 'несимметричность' легко устранить, выделив из матрицы $U$ диагональную матрицу $D$ с ведущими элементами $d_i$ на диагонали».
  
  - Инфографика: ![[Infographics-LDU.pdf]]

---

## Вопросы

- Почему для симметричной матрицы $U = L^{\top}$ в LDU-разложении?
- Как связано LDU-разложение с разложением Холецкого?
- Можно ли использовать LDU для ускорения вычисления обратной матрицы?
- Как изменяется LDU при перестановках строк?
- Существует ли обобщение LDU на блочные матрицы?