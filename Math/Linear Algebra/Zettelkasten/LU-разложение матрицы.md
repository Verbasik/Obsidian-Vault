## Суть

**LU-разложение** — это представление квадратной матрицы $A$ в виде произведения **нижней треугольной** матрицы $L$ (с единицами на диагонали) и **верхней треугольной** матрицы $U$:

$$
A = LU
$$

Это матричная форма метода исключения Гаусса: $L$ содержит множители исключения, а $U$ — результат прямого хода. LU-разложение эквивалентно процессу исключения и позволяет эффективно решать множество систем с одной матрицей $A$ и разными правыми частями.

---

## Детали

### Определение

**LU-разложением** матрицы $A \in \mathbb{R}^{n \times n}$ называется её представление:

$$
A = LU
$$

где:
- $L$ — **нижняя треугольная** матрица с **единицами на диагонали** (unit lower triangular);
- $U$ — **верхняя треугольная** матрица.

### Связь с методом исключения

Процесс исключения Гаусса можно записать как:

$$
E_{n-1} \cdots E_2 E_1 A = U
$$

где $E_i$ — элементарные матрицы исключения.

Умножая обе части слева на обратные матрицы:

$$
A = E_1^{-1} E_2^{-1} \cdots E_{n-1}^{-1} U
$$

Полагая:
$$
L = E_1^{-1} E_2^{-1} \cdots E_{n-1}^{-1}
$$

получаем:
$$
A = LU
$$

### Структура матрицы L

Матрица $L$ имеет замечательное свойство: **её элементы ниже диагонали — это в точности множители исключения** $l_{ij}$ из процесса Гаусса.

$$
L = \begin{bmatrix}
1 & 0 & 0 & \cdots & 0 \\
l_{21} & 1 & 0 & \cdots & 0 \\
l_{31} & l_{32} & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
l_{n1} & l_{n2} & l_{n3} & \cdots & 1
\end{bmatrix}
$$

где $l_{ij}$ — множитель, на который умножалась $j$-я строка при исключении из $i$-й.

### Вычисление LU-разложения

**Алгоритм** (без перестановок):

1. Выполнить прямой ход метода Гаусса для $A$, получить $U$;
2. Записать множители исключения $l_{ij}$ в матрицу $L$;
3. Результат: $A = LU$.

**Вычислительная сложность**: $\approx \frac{n^3}{3}$ операций (та же, что и для исключения).

### Решение систем с LU-разложением

Для решения $Ax = b$ с известным LU-разложением:

**Шаг 1**: Решить $Ly = b$ (прямая подстановка);
**Шаг 2**: Решить $Ux = y$ (обратная подстановка).

Так как $A = LU$, то:
$$
Ax = LUx = L(Ux) = Ly = b
$$

**Преимущество**: Если нужно решить много систем с одной $A$ и разными $b$, LU-разложение вычисляется **один раз**, а затем для каждого $b$ требуется только $O(n^2)$ операций (две подстановки вместо $O(n^3)$).

### Условия существования

**Теорема**: Матрица $A$ имеет LU-разложение (без перестановок) тогда и только тогда, когда **все ведущие элементы ненулевые**, т.е. метод исключения проходит без перестановок.

Если в процессе исключения встречается нулевой ведущий элемент, необходимо применить **перестановки строк**.

### Единственность

**Теорема**: Если $A$ невырожденная и имеет LU-разложение, то оно **единственно** при условии, что $L$ имеет единицы на диагонали.

---

## Примеры

### Пример из книги (3×3)

Исходная матрица:
$$
A = \begin{bmatrix}
2 & 1 & 1 \\
4 & 1 & 0 \\
-2 & 2 & 1
\end{bmatrix}
$$

**Процесс исключения**:
- Множитель $l_{21} = 2$: вычесть из строки 2 строку 1, умноженную на 2;
- Множитель $l_{31} = -1$: вычесть из строки 3 строку 1, умноженную на $(-1)$, т.е. прибавить;
- Множитель $l_{32} = -3$: вычесть из строки 3 строку 2, умноженную на $(-3)$.

**Результат**:
$$
U = \begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 0 & -4
\end{bmatrix}
$$

**Матрица L**:
$$
L = \begin{bmatrix}
1 & 0 & 0 \\
2 & 1 & 0 \\
-1 & -3 & 1
\end{bmatrix}
$$

**Проверка** $A = LU$:
$$
LU = \begin{bmatrix}
1 & 0 & 0 \\
2 & 1 & 0 \\
-1 & -3 & 1
\end{bmatrix}
\begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 0 & -4
\end{bmatrix}
= \begin{bmatrix}
2 & 1 & 1 \\
4 & 1 & 0 \\
-2 & 2 & 1
\end{bmatrix} = A \quad \checkmark
$$

### Простой пример 2×2

$$
A = \begin{bmatrix} 3 & 6 \\ 1 & 5 \end{bmatrix}
$$

**Исключение**: Множитель $l_{21} = \frac{1}{3}$

$$
U = \begin{bmatrix} 3 & 6 \\ 0 & 3 \end{bmatrix}, \quad
L = \begin{bmatrix} 1 & 0 \\ \frac{1}{3} & 1 \end{bmatrix}
$$

**Проверка**:
$$
LU = \begin{bmatrix} 1 & 0 \\ \frac{1}{3} & 1 \end{bmatrix}
\begin{bmatrix} 3 & 6 \\ 0 & 3 \end{bmatrix}
= \begin{bmatrix} 3 & 6 \\ 1 & 5 \end{bmatrix} = A \quad \checkmark
$$

### Решение системы через LU

Система $Ax = b$ с $b = \begin{bmatrix} 1 \\ -2 \\ 7 \end{bmatrix}$:

**Шаг 1**: Решить $Ly = b$
$$
\begin{bmatrix}
1 & 0 & 0 \\
2 & 1 & 0 \\
-1 & -3 & 1
\end{bmatrix}
\begin{bmatrix} y_1 \\ y_2 \\ y_3 \end{bmatrix}
= \begin{bmatrix} 1 \\ -2 \\ 7 \end{bmatrix}
$$

Прямая подстановка:
- $y_1 = 1$
- $2(1) + y_2 = -2 \Rightarrow y_2 = -4$
- $(-1)(1) + (-3)(-4) + y_3 = 7 \Rightarrow y_3 = -4$

Получили: $y = \begin{bmatrix} 1 \\ -4 \\ -4 \end{bmatrix}$

**Шаг 2**: Решить $Ux = y$
$$
\begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 0 & -4
\end{bmatrix}
\begin{bmatrix} u \\ v \\ w \end{bmatrix}
= \begin{bmatrix} 1 \\ -4 \\ -4 \end{bmatrix}
$$

Обратная подстановка:
- $-4w = -4 \Rightarrow w = 1$
- $-v - 2(1) = -4 \Rightarrow v = 2$
- $2u + 2 + 1 = 1 \Rightarrow u = -1$

Решение: $x = \begin{bmatrix} -1 \\ 2 \\ 1 \end{bmatrix}$ ✓

### Пример невозможности LU без перестановок

$$
A = \begin{bmatrix} 0 & 1 \\ 1 & 1 \end{bmatrix}
$$

Первый ведущий элемент $a_{11} = 0$ — **нулевой**!

Метод исключения без перестановок невозможен, значит LU-разложение (в стандартной форме) не существует.

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.4, стр. 30–36
- Ключевая цитата:
  
  > «Если все ведущие элементы отличны от нуля, то матрица $A$ может быть представлена в виде произведения $LU$ нижней треугольной матрицы $L$ и верхней треугольной матрицы $U$. Элементы главной диагонали матрицы $L$ равны единице, а поддиагональными элементами являются множители $l_{ij}$, с которыми $j$-я строка вычиталась из $i$-й в процессе исключения».

---

## Вопросы

- Как изменяется LU-разложение при масштабировании матрицы?
- Можно ли найти LU-разложение для прямоугольных матриц?
- Как связаны LU-разложение и определитель матрицы?
- Существует ли параллельный алгоритм вычисления LU-разложения?
- Как численная устойчивость метода исключения влияет на точность LU-разложения?