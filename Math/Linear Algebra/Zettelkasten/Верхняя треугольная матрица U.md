## Суть

**Верхняя треугольная матрица** $U$ (от англ. **U**pper triangular) — это квадратная матрица, у которой все элементы **ниже главной диагонали равны нулю**. Это результат прямого хода метода исключения Гаусса, приводящего систему к виду, удобному для обратной подстановки.

В результате этих исключений получается более простая система, состоящая из $n-1$ уравнений с $n-1$ неизвестными. Процесс повторяется, пока не останется только одно уравнение с одним неизвестным, которое можно решить непосредственно. Теперь нетрудно произвести обратный ход и определить все другие неизвестные в обратном порядке.

---

## Детали

### Определение

Квадратная матрица $U$ размера $n \times n$ называется **верхней треугольной**, если:

$$
u_{ij} = 0 \quad \text{для всех } i > j
$$

То есть все элементы под главной диагональю равны нулю.

**Общий вид**:
$$
U = \begin{bmatrix}
u_{11} & u_{12} & u_{13} & \cdots & u_{1n} \\
0 & u_{22} & u_{23} & \cdots & u_{2n} \\
0 & 0 & u_{33} & \cdots & u_{3n} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \cdots & u_{nn}
\end{bmatrix}
$$

### Связь с методом исключения

Прямой ход метода Гаусса преобразует матрицу коэффициентов $A$ в верхнюю треугольную матрицу $U$:

$$
A \xrightarrow{\text{исключение}} U
$$

**Диагональные элементы** $u_{11}, u_{22}, \ldots, u_{nn}$ — это **ведущие элементы** на каждом шаге исключения.

### Система в верхнем треугольном виде

После прямого хода система $Ax = b$ превращается в:
$$
Ux = c
$$

где $c$ — преобразованная правая часть.

**Пример** (из книги):
$$
\begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 0 & -4
\end{bmatrix}
\begin{bmatrix} u \\ v \\ w \end{bmatrix}
=
\begin{bmatrix} 1 \\ -4 \\ -4 \end{bmatrix}
$$

Эта система легко решается обратной подстановкой.

### Свойства верхних треугольных матриц

**1. Произведение** верхних треугольных матриц — верхняя треугольная:
$$
U_1, U_2 \text{ — верхние треугольные} \Rightarrow U_1 U_2 \text{ — верхняя треугольная}
$$

**2. Обратная** к верхней треугольной (если существует) — верхняя треугольная:
$$
U^{-1} \text{ — верхняя треугольная, если } U \text{ обратима}
$$

**3. Определитель** равен произведению диагональных элементов:
$$
\det(U) = u_{11} u_{22} \cdots u_{nn}
$$

**4. Обратимость**: $U$ обратима $\Leftrightarrow$ все диагональные элементы ненулевые.

### Решение систем с верхней треугольной матрицей

Система $Ux = c$ решается **обратной подстановкой**:

Начиная с последнего уравнения:
$$
u_{nn}x_n = c_n \quad \Rightarrow \quad x_n = \frac{c_n}{u_{nn}}
$$

Затем предпоследнее:
$$
u_{n-1,n-1}x_{n-1} + u_{n-1,n}x_n = c_{n-1} \quad \Rightarrow \quad x_{n-1} = \frac{c_{n-1} - u_{n-1,n}x_n}{u_{n-1,n-1}}
$$

И так далее вверх до первого уравнения.

---

## Примеры

### Пример из книги (3×3)

После прямого хода исключения:
$$
U = \begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
0 & 0 & -4
\end{bmatrix}
$$

**Структура**:
- Ведущие элементы (на диагонали): $2, -1, -4$;
- Элементы выше диагонали: произвольные;
- Элементы ниже диагонали: **все нули**.

### Общий пример 4×4

$$
U = \begin{bmatrix}
3 & 5 & 2 & 7 \\
0 & -2 & 1 & 4 \\
0 & 0 & 6 & -1 \\
0 & 0 & 0 & 8
\end{bmatrix}
$$

Определитель: $\det(U) = 3 \cdot (-2) \cdot 6 \cdot 8 = -288$

Так как $\det(U) \neq 0$, матрица обратима.

### Специальный случай: диагональная матрица

Если все элементы выше диагонали тоже нули, получаем **диагональную матрицу**:
$$
D = \begin{bmatrix}
d_1 & 0 & 0 \\
0 & d_2 & 0 \\
0 & 0 & d_3
\end{bmatrix}
$$

Это одновременно верхняя **и** нижняя треугольная матрица.

Система $Dx = c$ решается тривиально:
$$
x_i = \frac{c_i}{d_i}
$$

### Вырожденная верхняя треугольная матрица

Если хотя бы один диагональный элемент равен нулю:
$$
U = \begin{bmatrix}
2 & 1 & 1 \\
0 & 0 & -2 \\
0 & 0 & -4
\end{bmatrix}
$$

Определитель: $\det(U) = 2 \cdot 0 \cdot (-4) = 0$

Матрица **вырождена**, обратная не существует, система либо несовместна, либо имеет бесконечно много решений.

### Геометрическая интерпретация

Умножение на верхнюю треугольную матрицу в $\mathbb{R}^2$:
$$
U = \begin{bmatrix} a & b \\ 0 & d \end{bmatrix}
$$

Преобразование:
1. Растяжение вдоль координатных осей ($a$ и $d$);
2. Сдвиг (shear) вдоль первой оси ($b$).

Квадрат с вершинами $(0,0), (1,0), (0,1), (1,1)$ превращается в параллелограмм.

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.2, стр. 14; § 1.4, стр. 30–36
- Ключевая цитата:
  
  > «Теперь процесс исключения завершён (по крайней мере в 'прямом' направлении). В результате мы получаем упрощенную систему... Порядок действий при решении этой системы очевиден».

---

## Вопросы

- Всегда ли метод исключения приводит к верхней треугольной матрице без перестановок?
- Как связана верхняя треугольная форма с собственными значениями матрицы?
- Существует ли эффективный алгоритм умножения двух верхних треугольных матриц?
- Можно ли использовать верхнюю треугольную форму для вычисления определителя?
- Как обобщается понятие верхней треугольной матрицы на блочные матрицы?