## Суть

**Формула $P \approx n^3/3$** — это точная математическая оценка числа арифметических операций, требуемых для прямого хода метода исключения Гаусса. Эта формула показывает, что вычислительная работа растёт как куб размера системы, что является фундаментальным результатом численной линейной алгебры.

Точная формула: $P = n^2 - n + (n-1)^2 - (n-1) + \cdots + 1^2 - 1 = \frac{n^3}{3} + O(n^2)$. При больших $n$ доминирует кубический член, поэтому используется приближение $P \approx n^3/3$.

---

## Детали

### Вывод формулы через суммирование

Число операций на каждом шаге прямого хода:

- **Шаг 1**: обработка $(n-1)$ строк с $n$ элементами → $(n-1) \cdot n = n^2 - n$;
- **Шаг 2**: обработка $(n-2)$ строк с $(n-1)$ элементами → $(n-2)(n-1) = (n-1)^2 - (n-1)$;
- **Шаг 3**: обработка $(n-3)$ строк с $(n-2)$ элементами → $(n-3)(n-2) = (n-2)^2 - (n-2)$
- ⋮
- **Шаг $(n-1)$**: обработка $1$ строки с $2$ элементами → $1 \cdot 2 = 1^2 - 1$.

**Общая сумма**:
$$
P = \sum_{k=1}^{n-1} k(k+1) = \sum_{k=1}^{n-1} (k^2 + k)
$$

### Применение формул для сумм степеней

Разбиваем на две суммы:
$$
P = \sum_{k=1}^{n-1} k^2 + \sum_{k=1}^{n-1} k
$$

Используем известные формулы:

1. **Сумма квадратов**:
   $$\sum_{k=1}^{m} k^2 = \frac{m(m+1)(2m+1)}{6}$$

2. **Сумма натуральных чисел**:
   $$\sum_{k=1}^{m} k = \frac{m(m+1)}{2}$$

Для $m = n-1$:
$$
P = \frac{(n-1)n(2n-1)}{6} + \frac{(n-1)n}{2}
$$

### Упрощение до кубической формы

Раскроем первое слагаемое:
$$
\frac{(n-1)n(2n-1)}{6} = \frac{n(2n^2 - 3n + 1)}{6} = \frac{2n^3 - 3n^2 + n}{6} = \frac{n^3}{3} - \frac{n^2}{2} + \frac{n}{6}
$$

Второе слагаемое:
$$
\frac{(n-1)n}{2} = \frac{n^2 - n}{2} = \frac{n^2}{2} - \frac{n}{2}
$$

Складываем:
$$
P = \frac{n^3}{3} - \frac{n^2}{2} + \frac{n}{6} + \frac{n^2}{2} - \frac{n}{2} = \frac{n^3}{3} - \frac{n}{3}
$$

**Точная формула**:
$$
P = \frac{n^3 - n}{3} = \frac{n(n^2-1)}{3} = \frac{n(n-1)(n+1)}{3}
$$

### Асимптотическое поведение

При $n \to \infty$:
$$
P = \frac{n^3}{3} - \frac{n}{3} = \frac{n^3}{3}\left(1 - \frac{1}{n^2}\right) \approx \frac{n^3}{3}
$$

Младшие члены становятся пренебрежимо малы:
$$
\frac{n/3}{n^3/3} = \frac{1}{n^2} \to 0
$$

### Точность приближения

Относительная погрешность приближения $P \approx n^3/3$:

$$
\varepsilon = \frac{|P_{\text{точное}} - P_{\text{прибл}}|}{P_{\text{точное}}} = \frac{n/3}{n^3/3 - n/3} = \frac{1}{n^2 - 1}
$$

**Примеры**:
- При $n=10$: $\varepsilon \approx 1\%$;
- При $n=100$: $\varepsilon \approx 0.01\%$;
- При $n=1000$: $\varepsilon \approx 0.0001\%$.

---

## Примеры

### Проверка для малых значений n

**Для $n=2$**:

Точная формула: $P = \frac{2(2-1)(2+1)}{3} = \frac{2 \cdot 1 \cdot 3}{3} = 2$

Приближение: $P \approx \frac{2^3}{3} = \frac{8}{3} \approx 2.67$

Реальный подсчёт: 1 шаг исключения с 2 операциями → $P = 2$ ✓

**Для $n=3$**:

Точная формула: $P = \frac{3 \cdot 2 \cdot 4}{3} = 8$

Приближение: $P \approx \frac{27}{3} = 9$

Реальный подсчёт:
- Шаг 1: $2 \times 3 = 6$ операций
- Шаг 2: $1 \times 2 = 2$ операции
- Итого: $P = 8$ ✓

**Для $n=10$**:

Точная формула: $P = \frac{10 \cdot 9 \cdot 11}{3} = 330$

Приближение: $P \approx \frac{1000}{3} \approx 333$

Разница: $3$ операции (менее 1%)

### Сравнение с альтернативными оценками

Стренг упоминает другие возможные оценки:

**Очень хорошая оценка числа операций**:
$$
P \approx \frac{n^3}{3}
$$

**Если $n$ достаточно большое**: величина $P \approx n^3/3$ является очень хорошей оценкой числа операций.

### Практическое значение

Для системы порядка $n=1000$:

Точное: $P = \frac{1000 \cdot 999 \cdot 1001}{3} = 333,333,000$

Приближение: $P \approx \frac{10^9}{3} = 333,333,333$

При скорости 1 GFLOPS (10⁹ операций в секунду):
- Время ≈ 0.33 секунды

При удвоении размера ($n=2000$):
- $P \approx \frac{8 \cdot 10^9}{3} \approx 2.67 \cdot 10^9$
- Время ≈ 2.67 секунды (в **8 раз** больше!)

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.2, стр. 15–16
- Ключевая цитата:
  
  > «Проверка легко осуществляется средствами математического анализа. Интеграл от $x^2$ от 0 до $n$ равен $n^3/3$, а интеграл от $x$ от 0 до $n$ равен $n^2/2$, что точно соответствует главным членам обеих сумм. Если $n$ оказывается достаточно большим, очень хорошей оценкой числа операций является величина $P \approx n^3/3$».

---

## Вопросы

- Можно ли получить формулу для $P$ через производящие функции?
- Как изменится формула при учёте операций с правой частью системы?
- Существует ли алгоритм с принципиально меньшим показателем степени, чем 3?
- Почему метод Штрассена с показателем $\log_2 7 \approx 2.807$ не используется широко?
- Как формула изменится для блочного варианта метода исключения?