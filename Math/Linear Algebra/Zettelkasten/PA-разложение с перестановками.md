## Суть

**PA-разложение** — это обобщение LU-разложения для случая, когда в процессе исключения Гаусса требуются **перестановки строк**. Вместо $A = LU$ получаем:

$$
PA = LU
$$

где $P$ — матрица перестановки, $L$ — нижняя треугольная с единицами на диагонали, $U$ — верхняя треугольная.

PA-разложение существует для **любой невырожденной матрицы**, в то время как стандартное LU-разложение может не существовать из-за нулевых ведущих элементов. Это делает PA-разложение универсальным инструментом для численного решения систем линейных уравнений.

---

## Детали

### Определение

**PA-разложением** матрицы $A$ называется представление:

$$
PA = LU
$$

где:
- $P$ — **матрица перестановки** (произведение матриц элементарных перестановок);
- $L$ — **нижняя треугольная** матрица с единицами на диагонали;
- $U$ — **верхняя треугольная** матрица.

Эквивалентная форма:
$$
A = P^{-1}LU = P^{\top}LU
$$

(так как для матриц перестановки $P^{-1} = P^{\top}$).

### Когда необходимо PA-разложение?

**1. Нулевой ведущий элемент**: Если в процессе исключения встречается нулевой элемент на диагонали.

**2. Малый ведущий элемент**: Даже если элемент ненулевой, но очень мал, перестановка улучшает **численную устойчивость**.

**3. Универсальность**: PA-разложение существует для **любой невырожденной** квадратной матрицы.

### Теорема существования

**Теорема**: Для любой невырожденной матрицы $A$ существует матрица перестановки $P$ такая, что $PA$ имеет LU-разложение:

$$
PA = LU
$$

**Доказательство** (идея): На каждом шаге исключения можно переставить строки так, чтобы получить ненулевой ведущий элемент. Для невырожденной матрицы всегда найдётся хотя бы один ненулевой элемент в нужном столбце.

### Построение PA-разложения

**Алгоритм** (исключение с частичным выбором ведущего элемента):

1. На $k$-м шаге найти строку $l \geq k$ с **максимальным по модулю** элементом в позиции $(l, k)$;
2. Переставить строки $k$ и $l$ (умножить слева на $P_k$);
3. Выполнить исключение для столбца $k$;
4. Повторить для следующих столбцов.

**Результат**:
$$
E_{n-1} P_{n-1} \cdots E_2 P_2 E_1 P_1 A = U
$$

Группируя перестановки и обращая:
$$
PA = LU
$$

где $P = P_{n-1} \cdots P_2 P_1$ (или их композиция в правильном порядке).

### Решение систем с PA-разложением

Для решения $Ax = b$ с известным PA-разложением:

**Шаг 1**: Переставить правую часть: $c = Pb$;

**Шаг 2**: Решить $Ly = c$ (прямая подстановка);

**Шаг 3**: Решить $Ux = y$ (обратная подстановка).

**Обоснование**:
$$
Ax = b \quad \Rightarrow \quad PAx = Pb \quad \Rightarrow \quad LUx = Pb
$$

### Частичный выбор ведущего элемента

**Стратегия**: На каждом шаге выбирать в качестве ведущего **максимальный по модулю** элемент в текущем столбце среди строк ниже диагонали.

**Преимущества**:
1. Избегает деления на нуль;
2. Минимизирует ошибки округления;
3. Улучшает численную устойчивость.

**Замечание**: это **не** гарантирует глобальную оптимальность, но значительно улучшает практическую точность.

---

## Примеры

### Пример из книги: простая перестановка

Матрица:
$$
A = \begin{bmatrix}
0 & 2 \\
3 & 4
\end{bmatrix}
$$

**Проблема**: $a_{11} = 0$ — нулевой ведущий элемент.

**Перестановка**:
$$
P = \begin{bmatrix}
0 & 1 \\
1 & 0
\end{bmatrix}
$$

$$
PA = \begin{bmatrix}
0 & 1 \\
1 & 0
\end{bmatrix}
\begin{bmatrix}
0 & 2 \\
3 & 4
\end{bmatrix}
= \begin{bmatrix}
3 & 4 \\
0 & 2
\end{bmatrix}
$$

**LU-разложение** $PA$:

Уже в верхнем треугольном виде! Но формально:
$$
L = \begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}, \quad
U = \begin{bmatrix}
3 & 4 \\
0 & 2
\end{bmatrix}
$$

**Проверка**:
$$
PA = LU = \begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
3 & 4 \\
0 & 2
\end{bmatrix}
= \begin{bmatrix}
3 & 4 \\
0 & 2
\end{bmatrix} \quad \checkmark
$$

### Пример с частичным выбором ведущего элемента

$$
A = \begin{bmatrix}
1 & 2 & 3 \\
2 & 4 & 5 \\
4 & 5 & 6
\end{bmatrix}
$$

**Шаг 1**: Ищем максимальный элемент в первом столбце.

Элементы: $|1| = 1$, $|2| = 2$, $|4| = 4$

Максимум: $a_{31} = 4$ → переставляем строки 1 и 3.

$$
P_1 = \begin{bmatrix}
0 & 0 & 1 \\
0 & 1 & 0 \\
1 & 0 & 0
\end{bmatrix}
$$

$$
P_1 A = \begin{bmatrix}
4 & 5 & 6 \\
2 & 4 & 5 \\
1 & 2 & 3
\end{bmatrix}
$$

**Исключение** из строк 2 и 3:
- $l_{21} = \frac{2}{4} = \frac{1}{2}$
- $l_{31} = \frac{1}{4}$

После исключения:
$$
\begin{bmatrix}
4 & 5 & 6 \\
0 & \frac{3}{2} & 2 \\
0 & \frac{3}{4} & \frac{3}{2}
\end{bmatrix}
$$

**Шаг 2**: Ищем максимальный элемент во втором столбце (строки 2-3).

Элементы: $|\frac{3}{2}| = 1.5$, $|\frac{3}{4}| = 0.75$

Максимум: $a_{22} = \frac{3}{2}$ → перестановка не нужна ($P_2 = I$).

**Исключение** из строки 3:
- $l_{32} = \frac{3/4}{3/2} = \frac{1}{2}$

Финальная верхняя треугольная:
$$
U = \begin{bmatrix}
4 & 5 & 6 \\
0 & \frac{3}{2} & 2 \\
0 & 0 & \frac{1}{2}
\end{bmatrix}
$$

**Матрица L**:
$$
L = \begin{bmatrix}
1 & 0 & 0 \\
\frac{1}{2} & 1 & 0 \\
\frac{1}{4} & \frac{1}{2} & 1
\end{bmatrix}
$$

**Результат**:
$$
P_1 A = LU
$$

где $P = P_1 = \begin{bmatrix} 0 & 0 & 1 \\ 0 & 1 & 0 \\ 1 & 0 & 0 \end{bmatrix}$.

### Решение системы с PA-разложением

Система $Ax = b$ с $b = \begin{bmatrix} 1 \\ -2 \\ 7 \end{bmatrix}$:

**Шаг 1**: $c = Pb$
$$
c = \begin{bmatrix}
0 & 0 & 1 \\
0 & 1 & 0 \\
1 & 0 & 0
\end{bmatrix}
\begin{bmatrix} 1 \\ -2 \\ 7 \end{bmatrix}
= \begin{bmatrix} 7 \\ -2 \\ 1 \end{bmatrix}
$$

**Шаг 2**: Решить $Ly = c$
$$
\begin{bmatrix}
1 & 0 & 0 \\
\frac{1}{2} & 1 & 0 \\
\frac{1}{4} & \frac{1}{2} & 1
\end{bmatrix}
\begin{bmatrix} y_1 \\ y_2 \\ y_3 \end{bmatrix}
= \begin{bmatrix} 7 \\ -2 \\ 1 \end{bmatrix}
$$

Прямая подстановка:
- $y_1 = 7$
- $\frac{1}{2}(7) + y_2 = -2 \Rightarrow y_2 = -5.5$
- $\frac{1}{4}(7) + \frac{1}{2}(-5.5) + y_3 = 1 \Rightarrow y_3 = 1.5$

**Шаг 3**: Решить $Ux = y$
$$
\begin{bmatrix}
4 & 5 & 6 \\
0 & \frac{3}{2} & 2 \\
0 & 0 & \frac{1}{2}
\end{bmatrix}
\begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix}
= \begin{bmatrix} 7 \\ -5.5 \\ 1.5 \end{bmatrix}
$$

Обратная подстановка даёт решение $x$.

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.5, стр. 40–43
- Ключевая цитата:
  
  > «Если матрица $A$ невырожденная, то существует такая **матрица перестановки** $P$, что **матрица PA допускает разложение** $PA = LU$ (или $PA = LDU$), что предпочтительнее с точки зрения машинных вычислений. В случае вырожденной матрицы никакое переупорядочение строк не позволяет избежать нулевых ведущих элементов».

---

## Вопросы

- Единственно ли PA-разложение для данной матрицы?
- Как выбрать оптимальную стратегию перестановок для минимизации ошибок?
- Можно ли использовать перестановки столбцов вместо строк (или вместе с ними)?
- Как PA-разложение связано с сингулярным разложением (SVD)?
- Существует ли эффективный параллельный алгоритм PA-разложения?