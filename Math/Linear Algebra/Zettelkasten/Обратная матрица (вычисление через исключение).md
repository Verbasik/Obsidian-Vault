## Суть

**Обратная матрица** $A^{-1}$ — это матрица, удовлетворяющая условию $AA^{-1} = A^{-1}A = I$. Вычисление обратной матрицы методом исключения Гаусса сводится к решению $n$ систем линейных уравнений с одной и той же матрицей коэффициентов, но разными правыми частями — столбцами единичной матрицы.

**Практический метод**: Применить исключение к расширенной матрице $[A | I]$, приводя её к виду $[I | A^{-1}]$. Операции, которые превращают $A$ в $I$, одновременно превращают $I$ в $A^{-1}$.

---

## Детали

### Определение обратной матрицы

Для квадратной матрицы $A \in \mathbb{R}^{n \times n}$ **обратной матрицей** $A^{-1}$ называется матрица, удовлетворяющая:

$$
AA^{-1} = I \quad \text{и} \quad A^{-1}A = I
$$

**Условие существования**: Обратная матрица существует тогда и только тогда, когда $A$ **невырожденная**, т.е. $\det(A) \neq 0$.

### Идея метода вычисления

Обратная матрица $A^{-1}$ решает $n$ систем уравнений одновременно:

$$
A \cdot (\text{столбец } j \text{ матрицы } A^{-1}) = \text{столбец } j \text{ матрицы } I = e_j
$$

где $e_j$ — $j$-й столбец единичной матрицы (вектор с 1 на $j$-й позиции и нулями в остальных).

**Обозначим**: $A^{-1} = [x_1 \ x_2 \ \cdots \ x_n]$, тогда:

$$
Ax_j = e_j \quad \text{для } j = 1, 2, \ldots, n
$$

### Расширенная матрица $[A | I]$

Вместо решения $n$ систем по отдельности, объединяем их в одну расширенную матрицу:

$$
[A | I] = [A | e_1 \ e_2 \ \cdots \ e_n]
$$

Применяя исключение Гаусса к этой расширенной матрице, одновременно решаем все $n$ систем.

### Алгоритм вычисления $A^{-1}$

**Шаг 1**: Записать расширенную матрицу $[A | I]$ размера $n \times 2n$

**Шаг 2**: Применить элементарные преобразования строк (прямой и обратный ход) для приведения левой части к единичной матрице:

$$
[A | I] \xrightarrow{\text{исключение}} [I | A^{-1}]
$$

**Шаг 3**: Правая часть полученной матрицы — это $A^{-1}$

**Обоснование**: Если $E$ — произведение всех элементарных матриц, преобразующих $A$ в $I$, то:

$$
EA = I \quad \Rightarrow \quad E = A^{-1}
$$

Применяя те же операции к $I$:

$$
EI = E = A^{-1}
$$

### Связь с LU-разложением

Если $A = LU$, то:

$$
A^{-1} = U^{-1}L^{-1}
$$

Обратные к треугольным матрицам вычисляются эффективно:

**Для нижней треугольной** $L$: решить системы $Lx_j = e_j$ прямой подстановкой;

**Для верхней треугольной** $U$: решить системы $Uy_j = e_j$ обратной подстановкой.

### Вычислительная сложность

**Метод Гаусса-Жордана** (приведение к $[I | A^{-1}]$):

$$
\approx n^3 \text{ операций}
$$

Это примерно **в 3 раза больше**, чем просто решение одной системы ($n^3/3$ операций).

**Через LU-разложение**:

1. Найти $LU$-разложение: $\approx n^3/3$ операций;
2. Решить $2n$ треугольных систем: $\approx n^3$ операций.

Итого: $\approx 4n^3/3$ операций (быстрее метода Гаусса-Жордана).

---

## Примеры

### Пример 2×2

$$
A = \begin{bmatrix}
2 & 1 \\
4 & 3
\end{bmatrix}
$$

**Расширенная матрица**:
$$
[A | I] = \left[\begin{array}{cc|cc}
2 & 1 & 1 & 0 \\
4 & 3 & 0 & 1
\end{array}\right]
$$

**Шаг 1**: Исключить элемент $(2,1)$ с множителем $l_{21} = 2$:
$$
\left[\begin{array}{cc|cc}
2 & 1 & 1 & 0 \\
0 & 1 & -2 & 1
\end{array}\right]
$$

**Шаг 2**: Обратная подстановка — обнулить элемент $(1,2)$:

Вычесть из первой строки вторую:
$$
\left[\begin{array}{cc|cc}
2 & 0 & 3 & -1 \\
0 & 1 & -2 & 1
\end{array}\right]
$$

**Шаг 3**: Нормализовать первую строку (разделить на 2):
$$
\left[\begin{array}{cc|cc}
1 & 0 & \frac{3}{2} & -\frac{1}{2} \\
0 & 1 & -2 & 1
\end{array}\right]
$$

**Результат**:
$$
A^{-1} = \begin{bmatrix}
\frac{3}{2} & -\frac{1}{2} \\
-2 & 1
\end{bmatrix}
$$

**Проверка**:
$$
AA^{-1} = \begin{bmatrix}
2 & 1 \\
4 & 3
\end{bmatrix}
\begin{bmatrix}
\frac{3}{2} & -\frac{1}{2} \\
-2 & 1
\end{bmatrix}
= \begin{bmatrix}
3 - 2 & -1 + 1 \\
6 - 6 & -2 + 3
\end{bmatrix}
= \begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix} = I \quad \checkmark
$$

### Пример 3×3 из книги

$$
A = \begin{bmatrix}
2 & 1 & 1 \\
4 & 1 & 0 \\
-2 & 2 & 1
\end{bmatrix}
$$

**Расширенная матрица**:
$$
\left[\begin{array}{ccc|ccc}
2 & 1 & 1 & 1 & 0 & 0 \\
4 & 1 & 0 & 0 & 1 & 0 \\
-2 & 2 & 1 & 0 & 0 & 1
\end{array}\right]
$$

**Прямой ход** (приведение к верхней треугольной):

После исключения элементов под диагональю:
$$
\left[\begin{array}{ccc|ccc}
2 & 1 & 1 & 1 & 0 & 0 \\
0 & -1 & -2 & -2 & 1 & 0 \\
0 & 0 & -4 & -5 & 3 & 1
\end{array}\right]
$$

**Обратный ход** (приведение к единичной матрице):

Обнуляем элементы над диагональю и нормализуем:
$$
\left[\begin{array}{ccc|ccc}
1 & 0 & 0 & \frac{1}{8} & \frac{1}{8} & -\frac{1}{8} \\
0 & 1 & 0 & -\frac{1}{2} & \frac{1}{2} & \frac{1}{2} \\
0 & 0 & 1 & \frac{5}{4} & -\frac{3}{4} & -\frac{1}{4}
\end{array}\right]
$$

**Результат**:
$$
A^{-1} = \begin{bmatrix}
\frac{1}{8} & \frac{1}{8} & -\frac{1}{8} \\
-\frac{1}{2} & \frac{1}{2} & \frac{1}{2} \\
\frac{5}{4} & -\frac{3}{4} & -\frac{1}{4}
\end{bmatrix}
$$

### Вырожденная матрица: обратная не существует

$$
A = \begin{bmatrix}
1 & 2 \\
2 & 4
\end{bmatrix}
$$

**Расширенная матрица**:
$$
\left[\begin{array}{cc|cc}
1 & 2 & 1 & 0 \\
2 & 4 & 0 & 1
\end{array}\right]
$$

**Исключение**:
$$
\left[\begin{array}{cc|cc}
1 & 2 & 1 & 0 \\
0 & 0 & -2 & 1
\end{array}\right]
$$

**Проблема**: нулевой ведущий элемент во второй строке, перестановка невозможна.

**Вывод**: матрица **вырожденная**, обратная **не существует**.

### Связь с решением системы

Для решения $Ax = b$ с известной $A^{-1}$:

$$
x = A^{-1}b
$$

**Пример**: $A$ как в первом примере, $b = \begin{bmatrix} 5 \\ 11 \end{bmatrix}$

$$
x = \begin{bmatrix}
\frac{3}{2} & -\frac{1}{2} \\
-2 & 1
\end{bmatrix}
\begin{bmatrix} 5 \\ 11 \end{bmatrix}
= \begin{bmatrix}
\frac{15}{2} - \frac{11}{2} \\
-10 + 11
\end{bmatrix}
= \begin{bmatrix} 2 \\ 1 \end{bmatrix}
$$

**Проверка**:
$$
Ax = \begin{bmatrix}
2 & 1 \\
4 & 3
\end{bmatrix}
\begin{bmatrix} 2 \\ 1 \end{bmatrix}
= \begin{bmatrix} 5 \\ 11 \end{bmatrix} = b \quad \checkmark
$$

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.5, стр. 44–47
- Ключевая цитата:
  
  > «Хороший способ — это описать каждый отдельный элемент матрицы $A^{-1}$... Этот элемент является **скалярным произведением** $i$-й строки матрицы $E$ и $j$-го столбца матрицы $A$... Скалярное произведение последней строки из $E$ и последнего столбца из $A$, отмеченных на рис. 1.1, даёт последний элемент матрицы $EA$».

---

## Вопросы

- Почему вычисление $A^{-1}$ требует примерно в 3 раза больше операций, чем решение одной системы?
- Всегда ли численно стабильно вычислять $A^{-1}$ методом Гаусса?
- Когда выгоднее вычислить $A^{-1}$ явно, а когда лучше использовать LU-разложение?
- Как связаны обратная матрица и псевдообратная для прямоугольных матриц?
- Можно ли распараллелить вычисление обратной матрицы?