## Суть

**Умножение матриц** — это операция композиции линейных преобразований, при которой произведение $AB$ двух матриц определяется так, чтобы $(AB)x = A(Bx)$ для любого вектора $x$. Стренг вводит умножение матриц через обобщение правила умножения матрицы на вектор.

Правило умножения произвольного вектора на матрицу теперь нужно обобщить до правила умножения матрицы на матрицу. Новая матрица коэффициентов $E$ действует на $x$ так же, как если бы сначала умножить его на матрицу $A$, а затем на матрицу $E$. Иначе говоря, для любого вектора $x$: $(EA)x = E(Ax)$.

---

## Детали

### Правило умножения матриц

Для матриц $A$ размера $m \times n$ и $B$ размера $n \times p$ произведение $AB$ — это матрица размера $m \times p$.

**Элемент $(i, j)$ произведения**:
$$
[AB]_{ij} = \sum_{k=1}^{n} a_{ik} b_{kj}
$$

Это **скалярное произведение** $i$-й строки матрицы $A$ на $j$-й столбец матрицы $B$.

### Интерпретация по столбцам

**Ключевое наблюдение Стренга**: $j$-й столбец произведения $AB$ равен $A$ умножить на $j$-й столбец $B$:

$$
[AB]_{\cdot j} = A \cdot [B]_{\cdot j}
$$

Если $B = [\mathbf{b}_1 \ \mathbf{b}_2 \ \cdots \ \mathbf{b}_p]$, то:
$$
AB = [A\mathbf{b}_1 \ A\mathbf{b}_2 \ \cdots \ A\mathbf{b}_p]
$$

### Условие согласованности размеров

Произведение $AB$ определено **тогда и только тогда**, когда:

**Число столбцов $A$ = Число строк $B$**

Размеры:
$$
(m \times n) \times (n \times p) = (m \times p)
$$

Средние размеры ($n$) должны совпадать.

### Свойства умножения матриц

**1. Ассоциативность**:
$$
(AB)C = A(BC)
$$

**2. Дистрибутивность**:
$$
A(B + C) = AB + AC
$$
$$
(A + B)C = AC + BC
$$

**3. Некоммутативность** (в общем случае):
$$
AB \neq BA
$$

**4. Единичная матрица** — нейтральный элемент:
$$
AI = IA = A
$$

### Произведение как композиция преобразований

Если $A$ и $B$ представляют линейные преобразования, то $AB$ представляет их **композицию**:

$$
(AB)x = A(Bx)
$$

Сначала применяется $B$, затем $A$ (порядок справа налево!).

---

## Примеры

### Умножение 2×2 матриц

$$
\begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix}
\begin{bmatrix} 5 & 6 \\ 7 & 8 \end{bmatrix}
= ?
$$

**По элементам**:

Элемент $(1,1)$: $1 \cdot 5 + 2 \cdot 7 = 5 + 14 = 19$  
Элемент $(1,2)$: $1 \cdot 6 + 2 \cdot 8 = 6 + 16 = 22$  
Элемент $(2,1)$: $3 \cdot 5 + 4 \cdot 7 = 15 + 28 = 43$  
Элемент $(2,2)$: $3 \cdot 6 + 4 \cdot 8 = 18 + 32 = 50$

$$
AB = \begin{bmatrix} 19 & 22 \\ 43 & 50 \end{bmatrix}
$$

### Некоммутативность

Поменяем порядок:
$$
BA = \begin{bmatrix} 5 & 6 \\ 7 & 8 \end{bmatrix}
\begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix}
$$

Элемент $(1,1)$: $5 \cdot 1 + 6 \cdot 3 = 5 + 18 = 23$

$$
BA = \begin{bmatrix} 23 & 34 \\ 31 & 46 \end{bmatrix} \neq AB
$$

### Умножение на единичную матрицу

$$
\begin{bmatrix} 2 & 3 \\ 1 & 4 \end{bmatrix}
\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}
= \begin{bmatrix} 2 & 3 \\ 1 & 4 \end{bmatrix}
$$

Единичная матрица не меняет результат.

### Пример из книги: элементарная матрица

Стренг рассматривает матрицу $E$, которая вычитает удвоенную первую строку из второй:

$$
E = \begin{bmatrix}
1 & 0 & 0 \\
-2 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
$$

Умножение $EA$ выполняет шаг исключения над матрицей $A$:

$$
EA = \begin{bmatrix}
1 & 0 & 0 \\
-2 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
2 & 1 & 1 \\
4 & 1 & 0 \\
-2 & 2 & 1
\end{bmatrix}
= \begin{bmatrix}
2 & 1 & 1 \\
0 & -1 & -2 \\
-2 & 2 & 1
\end{bmatrix}
$$

Вторая строка стала: $-2 \cdot (2, 1, 1) + (4, 1, 0) = (0, -1, -2)$ ✓

### Размеры несовместимы

Попытка умножить $2 \times 3$ на $2 \times 2$:
$$
\begin{bmatrix} 1 & 2 & 3 \\ 4 & 5 & 6 \end{bmatrix}
\begin{bmatrix} 7 & 8 \\ 9 & 10 \end{bmatrix}
= \text{НЕВОЗМОЖНО}
$$

Число столбцов первой (3) $\neq$ число строк второй (2).

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.3, стр. 17–27
- Ключевая цитата:
  
  > «Правило умножения произвольного вектора на матрицу теперь нужно обобщить до правила умножения матрицы на матрицу... Новая матрица коэффициентов $E$ действует на $x$ так же, как если бы сначала умножить его на матрицу $A$, а затем на матрицу $E$. Иначе говоря, для любого вектора $x$: $(EA)x = E(Ax)$».

---

## Вопросы

- Почему умножение матриц некоммутативно, в отличие от умножения чисел?
- Как связано умножение матриц с композицией линейных отображений?
- Существуют ли матрицы, для которых $AB = BA$?
- Можно ли определить умножение матриц так, чтобы оно было коммутативно?
- Почему порядок применения преобразований в $(AB)x$ — справа налево?