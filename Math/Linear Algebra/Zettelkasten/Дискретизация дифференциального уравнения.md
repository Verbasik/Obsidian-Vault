## Суть

**Дискретизация дифференциального уравнения** — это процесс преобразования непрерывной задачи (с бесконечным числом неизвестных значений функции) в дискретную задачу линейной алгебры (с конечным числом неизвестных). Непрерывная функция $u(x)$ заменяется набором приближенных значений $u_1, u_2, \ldots, u_n$ в выбранных узлах сетки, а производные заменяются разностными отношениями. Результат — система линейных уравнений $Au = b$.

$$
-\frac{d^2u}{dx^2} = f(x) \quad \Rightarrow \quad -u_{j+1} + 2u_j - u_{j-1} = h^2 f(jh)
$$

---

## Детали

### Построение дискретной сетки

Интервал $[0, 1]$ разбивается на $n+1$ равных частей длиной $h = 1/(n+1)$. Узлы сетки: $x_j = jh$, где $j = 0, 1, 2, \ldots, n, n+1$.

**Граничные узлы:** $x_0 = 0$, $x_{n+1} = 1$ (здесь $u_0 = 0$, $u_{n+1} = 0$ по краевым условиям)

**Внутренние узлы:** $x_1 = h, x_2 = 2h, \ldots, x_n = nh$ (здесь ищутся неизвестные $u_1, u_2, \ldots, u_n$)

Таким образом, непрерывная задача с бесконечным числом значений $u(x)$ заменяется задачей с $n$ неизвестными.

### Аппроксимация производных конечными разностями

Вторая производная заменяется **центральной разностной схемой**:

$$
\frac{d^2u}{dx^2}(x_j) \approx \frac{u(x_j + h) - 2u(x_j) + u(x_j - h)}{h^2} = \frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}
$$

Подставляя в исходное уравнение $-\frac{d^2u}{dx^2} = f(x)$, получаем:

$$
-\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} = f(x_j)
$$

Умножая на $h^2$:

$$
-u_{j+1} + 2u_j - u_{j-1} = h^2 f(jh), \quad j = 1, 2, \ldots, n
$$

Это $n$ уравнений для $n$ неизвестных $u_1, \ldots, u_n$.

### Матричная форма

Система уравнений записывается в матричном виде $Au = b$:

$$
\begin{bmatrix} 2 & -1 & 0 & \cdots & 0 \\ -1 & 2 & -1 & \cdots & 0 \\ 0 & -1 & 2 & \cdots & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & 0 & \cdots & 2 \end{bmatrix} \begin{bmatrix} u_1 \\ u_2 \\ u_3 \\ \vdots \\ u_n \end{bmatrix} = h^2 \begin{bmatrix} f(h) \\ f(2h) \\ f(3h) \\ \vdots \\ f(nh) \end{bmatrix}
$$

Матрица $A$ — **трехдиагональная симметрическая положительно определенная**.

---

## Примеры

**Пример 1: Дискретизация с $n = 5$ (шаг $h = 1/6$)**

Узлы сетки: $x_0 = 0, x_1 = 1/6, x_2 = 2/6, x_3 = 3/6, x_4 = 4/6, x_5 = 5/6, x_6 = 1$

Матрица системы (из книги, стр. 54):

$$
\begin{bmatrix} 2 & -1 & 0 & 0 & 0 \\ -1 & 2 & -1 & 0 & 0 \\ 0 & -1 & 2 & -1 & 0 \\ 0 & 0 & -1 & 2 & -1 \\ 0 & 0 & 0 & -1 & 2 \end{bmatrix} \begin{bmatrix} u_1 \\ u_2 \\ u_3 \\ u_4 \\ u_5 \end{bmatrix} = \frac{1}{36} \begin{bmatrix} f(h) \\ f(2h) \\ f(3h) \\ f(4h) \\ f(5h) \end{bmatrix}
$$


**Пример 2: Аппроксимация первой производной**

Для первой производной используются односторонние или центральные разности:

**Правая разность:**
$$
\frac{du}{dx} \approx \frac{u(x+h) - u(x)}{h}
$$

**Левая разность:**
$$
\frac{du}{dx} \approx \frac{u(x) - u(x-h)}{h}
$$

**Центральная разность (самая точная):**
$$
\frac{du}{dx} \approx \frac{u(x+h) - u(x-h)}{2h}
$$


**Пример 3: Дискретизация с $f(x) = 1$**

$$
-u_{j+1} + 2u_j - u_{j-1} = h^2
$$

Для $h = 1/6$:

$$
-u_{j+1} + 2u_j - u_{j-1} = \frac{1}{36}
$$


**Пример 4: Проверка порядка аппроксимации**

Разложение Тейлора показывает, что ошибка аппроксимации второй производной центральной разностью имеет порядок $O(h^2)$:

$$
\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} = u''(x_j) + \frac{h^2}{12}u^{(4)}(x_j) + O(h^4)
$$

При уменьшении $h$ в 2 раза ошибка уменьшается в 4 раза.


**Пример 5: Учет ненулевых граничных условий**

Если $u(0) = \alpha \neq 0$, $u(1) = \beta \neq 0$, то:
- При $j = 1$: $-u_2 + 2u_1 - u_0 = h^2f(h) \Rightarrow -u_2 + 2u_1 = h^2f(h) + \alpha$
- При $j = n$: $-u_{n+1} + 2u_n - u_{n-1} = h^2f(nh) \Rightarrow 2u_n - u_{n-1} = h^2f(nh) + \beta$

Граничные условия входят в правую часть.

**Пример 6: Сравнение решений при разных $h$**

| $h$ | $n$ | $u(0.5)$ точное | $u(0.5)$ дискретное | Ошибка |
|-----|-----|-----------------|---------------------|---------|
| 1/4 | 3 | 0.125 | 0.1250 | 0.0000 |
| 1/8 | 7 | 0.125 | 0.1250 | 0.0000 |
| 1/16 | 15 | 0.125 | 0.1250 | 0.0000 |

Для $f(x) = 1$ схема дает точное решение в узлах сетки.


**Пример 7: Неравномерная сетка**

Можно использовать неравномерную сетку с шагами $h_j = x_{j+1} - x_j$. Разностная схема усложняется:

$$
\frac{u_{j+1} - u_j}{h_j} - \frac{u_j - u_{j-1}}{h_{j-1}} = \text{(среднее значение)}
$$

**Пример 8: Дискретизация в 2D**

Для уравнения Лапласа $-\frac{\partial^2 u}{\partial x^2} - \frac{\partial^2 u}{\partial y^2} = f(x, y)$ на квадрате получается система с $n^2$ неизвестными и **пятидиагональной** структурой матрицы (ленточная с шириной $\sim n$).

---
## Инфографика:

![[Дискретизация дифференциального уравнения.pdf]]

---
## Источник

- Документ: [[Линейная_алгебра_и_её_применения.pdf]]
- Раздел/страницы: § 1.6, стр. 52-54
- Ключевая цитата:
  
  > «Напомним, что наша цель — получить задачу, которая дискретна (конечномерна), или, другими словами, является задачей линейной алгебры. По этим соображениям мы не можем допустить более чем конечное количество информации о функции $f$ и возьмем лишь ее значения в равномерно расположенных точках $x = h, x = 2h, \ldots, x = nh$.»

---
## Вопросы

- Как влияет выбор шага $h$ на точность и вычислительную сложность?
- Почему центральная разностная схема точнее односторонних?
- Можно ли дискретизировать нелинейные дифференциальные уравнения?
- Как связана дискретизация с методом конечных элементов?
- Что происходит при стремлении $h \to 0$?