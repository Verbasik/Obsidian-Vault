## Суть

**Матрица перестановки** $P$ — это квадратная матрица, которая при умножении слева на другую матрицу **переставляет её строки**. Матрица перестановки получается из единичной матрицы перестановкой строк и используется в методе исключения Гаусса для преодоления проблемы нулевого ведущего элемента.

Умножение $PA$ переставляет строки матрицы $A$ в том же порядке, в каком переставлены строки единичной матрицы для получения $P$. Матрицы перестановки обратимы, и их обратная тоже является матрицей перестановки.

---

## Детали

### Определение

**Матрица перестановки** $P$ — это матрица, полученная из единичной матрицы $I$ перестановкой строк.

**Общий вид** для перестановки двух строк $k$ и $l$ в матрице размера $n \times n$:

$$
P_{kl} = \begin{bmatrix}
1 & & & & & \\
& \ddots & & & & \\
& & 0 & \cdots & 1 & \\
& & \vdots & \ddots & \vdots & \\
& & 1 & \cdots & 0 & \\
& & & & & \ddots \\
& & & & & & 1
\end{bmatrix}
$$

где единицы в позициях $(k, l)$ и $(l, k)$, а в позициях $(k, k)$ и $(l, l)$ — нули.

### Действие матрицы перестановки

Умножение слева:
$$
PA
$$

переставляет строки матрицы $A$ **в том же порядке**, в каком переставлены строки единичной матрицы в $P$.

**Умножение справа**:
$$
AP
$$

переставляет **столбцы** матрицы $A$.

### Свойства матриц перестановки

**1. Обратимость**: Каждая матрица перестановки обратима.

Обратная матрица — это та же перестановка, применённая в обратном порядке.

**2. Ортогональность**: 
$$
P^{\top} P = I = P P^{\top}
$$

Следовательно:
$$
P^{-1} = P^{\top}
$$

**3. Определитель**: 
$$
\det(P) = \pm 1
$$

- $\det(P) = +1$, если перестановка чётная;
- $\det(P) = -1$, если перестановка нечётная.

**4. Произведение**: Произведение матриц перестановок — матрица перестановки.

### Простейшая перестановка: обмен двух строк

Для обмена строк $i$ и $j$ ($i < j$) матрица перестановки $P_{ij}$ имеет вид:

- Единицы на главной диагонали, **кроме** позиций $(i, i)$ и $(j, j)$;
- Единицы в позициях $(i, j)$ и $(j, i)$;
- Нули в позициях $(i, i)$ и $(j, j)$.

**Пример** (обмен строк 2 и 3 в матрице 4×4):
$$
P_{23} = \begin{bmatrix}
1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

### Применение в методе исключения

Когда на $k$-м шаге возникает нулевой ведущий элемент, находим строку $l > k$ с ненулевым элементом в позиции $(l, k)$ и применяем:

$$
P_{kl} A
$$

Это переставляет строки $k$ и $l$, устраняя нулевой ведущий элемент.

**Общая схема** с перестановками:
$$
E_{n-1} P_{n-1} \cdots E_2 P_2 E_1 P_1 A = U
$$

или компактно:
$$
PA = LU
$$

где $P$ — произведение всех матриц перестановок.

---

## Примеры

### Пример из книги: перестановка строк 1 и 2

**Матрица перестановки**:
$$
P = \begin{bmatrix}
0 & 1 \\
1 & 0
\end{bmatrix}
$$

**Применение к матрице**:
$$
A = \begin{bmatrix}
0 & 2 \\
3 & 4
\end{bmatrix}
$$

$$
PA = \begin{bmatrix}
0 & 1 \\
1 & 0
\end{bmatrix}
\begin{bmatrix}
0 & 2 \\
3 & 4
\end{bmatrix}
= \begin{bmatrix}
3 & 4 \\
0 & 2
\end{bmatrix}
$$

Строки **поменялись местами**: первая стала второй, вторая — первой.

**Проверка обратной**:
$$
P^{-1} = P^{\top} = \begin{bmatrix}
0 & 1 \\
1 & 0
\end{bmatrix} = P
$$

Применяя $P$ дважды, получаем исходную матрицу:
$$
P(PA) = P^2 A = IA = A \quad \checkmark
$$

### Перестановка строк 2 и 3 в матрице 3×3

$$
P_{23} = \begin{bmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{bmatrix}
$$

$$
A = \begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{bmatrix}
$$

$$
P_{23} A = \begin{bmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{bmatrix}
= \begin{bmatrix}
1 & 2 & 3 \\
7 & 8 & 9 \\
4 & 5 & 6
\end{bmatrix}
$$

Строки 2 и 3 поменялись местами ✓

### Перестановка столбцов (умножение справа)

$$
AP_{23} = \begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{bmatrix}
= \begin{bmatrix}
1 & 3 & 2 \\
4 & 6 & 5 \\
7 & 9 & 8
\end{bmatrix}
$$

Столбцы 2 и 3 поменялись местами ✓

### Композиция перестановок

Перестановка строк 1↔2, затем 2↔3:

$$
P_1 = \begin{bmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1
\end{bmatrix}, \quad
P_2 = \begin{bmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{bmatrix}
$$

$$
P_2 P_1 = \begin{bmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1
\end{bmatrix}
= \begin{bmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
1 & 0 & 0
\end{bmatrix}
$$

Результат: циклическая перестановка строк (1→2→3→1).

### Определитель матрицы перестановки

Для $P_{12}$ (обмен двух строк):
$$
\det(P_{12}) = \det\begin{bmatrix}
0 & 1 \\
1 & 0
\end{bmatrix}
= 0 \cdot 0 - 1 \cdot 1 = -1
$$

Одна транспозиция → нечётная перестановка → $\det = -1$ ✓

Для циклической перестановки выше:
$$
\det(P_2 P_1) = \det(P_2) \cdot \det(P_1) = (-1) \cdot (-1) = +1
$$

Две транспозиции → чётная перестановка → $\det = +1$ ✓

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.5, стр. 40–41
- Ключевая цитата:
  
  > «Такой **матрицей перестановки** является матрица $P = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}$, умножение на которую матрицы $A$ переставляет строки последней... Конечно, такую же операцию $P$ осуществляет с вектором $b$, перестановке его компоненты $b_1$ и $b_2$».

---

## Вопросы

- Сколько различных матриц перестановки существует для матриц порядка $n$?
- Как связаны знак определителя и чётность перестановки?
- Можно ли представить любую перестановку как произведение транспозиций?
- Как эффективно вычислить обратную матрицу перестановки?
- Образуют ли матрицы перестановки группу?