## Суть

**Формула операций для ленточных матриц** дает точную оценку числа арифметических операций (делений и умножений-вычитаний), необходимых для LDU-разложения ленточной матрицы с шириной ленты $w$:

$$
P = \frac{1}{3}w(w-1)(3n - 2w + 1)
$$

Эта формула обобщает известную формулу $P \approx \frac{n^3}{3}$ для плотных матриц (когда $w = n$) и показывает, что при малой ширине ленты сложность становится линейной: $P \approx w^2 n$ при $w \ll n$.

---

## Детали

### Вывод формулы

Формула получается подсчетом операций на каждом шаге исключения Гаусса.

**На шаге $j$ ($j = 1, 2, \ldots, n-1$):**
- Число обнуляемых элементов под ведущим: $\min(w, n-j)$;
- Для каждого обнуляемого элемента: 1 деление (для множителя) + $\min(w, n-j)$ умножений-вычитаний.

Точный подсчет с учетом краевых эффектов (когда $j$ близко к $n$) приводит к формуле:

$$
P = \sum_{j=1}^{n-1} \min(w, n-j) \cdot [\min(w, n-j) + 1]
$$

После упрощения получаем:

$$
P = \frac{1}{3}w(w-1)(3n - 2w + 1)
$$

### Асимптотическое поведение

**При $w \ll n$ (узкая лента):**

$$
P \approx \frac{1}{3}w(w-1) \cdot 3n = w(w-1)n \approx w^2 n
$$

Линейная зависимость от $n$!

**При $w = n$ (плотная матрица):**

$$
P = \frac{1}{3}n(n-1)(3n - 2n + 1) = \frac{1}{3}n(n-1)(n+1) = \frac{n(n^2-1)}{3} \approx \frac{n^3}{3}
$$

Восстанавливается известная формула для плотных матриц.

**При $w = 1$ (трехдиагональная):**

$$
P = \frac{1}{3} \cdot 1 \cdot 0 \cdot (3n - 2 + 1) = 0
$$

Формула дает 0 из-за множителя $(w-1)$, но реальная сложность $P \approx 2n$. Формула неточна для очень малых $w$.

### Модификация для симметричных матриц

Для **симметричных** ленточных матриц число операций примерно вдвое меньше:

$$
P_{\text{симм}} \approx \frac{1}{2}P = \frac{1}{6}w(w-1)(3n - 2w + 1)
$$

Это связано с тем, что достаточно вычислять только нижнюю (или верхнюю) часть матрицы.

### Сравнение со сложностью обратной подстановки

Формула дает сложность **прямого хода** (построения $L$, $D$, $U$).

Обратная подстановка требует дополнительно:

$$
P_{\text{back}} \approx nw
$$

операций, что существенно меньше $w^2 n$ для прямого хода при $w > 1$.

---

## Примеры

**Пример 1: Проверка для плотной матрицы ($w = n = 5$)**

$$
P = \frac{1}{3} \cdot 5 \cdot 4 \cdot (15 - 10 + 1) = \frac{1}{3} \cdot 20 \cdot 6 = 40
$$

Известная формула: $\frac{n^3}{3} = \frac{125}{3} \approx 41.67$

Близкие результаты (небольшое расхождение из-за граничных эффектов).


**Пример 2: Трехдиагональная матрица ($w = 1$, $n = 100$)**

$$
P = \frac{1}{3} \cdot 1 \cdot 0 \cdot 299 = 0
$$

Формула неприменима! Реальная оценка: $P \approx 2n = 200$ операций.

**Для $w = 1$ используйте $P \approx 2(n-1)$.**


**Пример 3: Пятидиагональная матрица ($w = 2$, $n = 100$)**

$$
P = \frac{1}{3} \cdot 2 \cdot 1 \cdot (300 - 4 + 1) = \frac{1}{3} \cdot 2 \cdot 297 = \frac{594}{3} = 198
$$

Асимптотическая оценка: $w^2 n = 4 \cdot 100 = 400$ операций

Формула дает более точное значение (примерно в 2 раза меньше из-за граничных эффектов).


**Пример 4: Зависимость от $n$ при $w = 10$**

| $n$ | $P$ (по формуле) | $P$ ($\approx 100n$) | Отклонение |
|-----|------------------|---------------------|------------|
| 50 | 7230 | 5000 | +45% |
| 100 | 14730 | 10000 | +47% |
| 500 | 74730 | 50000 | +49% |
| 1000 | 149730 | 100000 | +50% |

При больших $n$ формула хорошо аппроксимируется как $P \approx 1.5 w^2 n$.


**Пример 5: Оптимальная ширина для заданного времени**

Пусть доступно $T = 10^6$ операций. Какая максимальная ширина $w$ допустима для $n = 1000$?

$$
\frac{1}{3}w(w-1)(3000 - 2w + 1) \approx 10^6
$$

При $w \ll n$: $w^2 \cdot 1000 \approx 10^6 \Rightarrow w^2 \approx 1000 \Rightarrow w \approx 32$

Точное решение (численно): $w \approx 28$


**Пример 6: Сравнение трех методов для $n = 1000$**

| Метод | Операции | Время (усл. ед.) |
|-------|----------|------------------|
| Правило Крамера | $\approx n! / n \approx 10^{2567}$ | бесконечность |
| Плотный Гаусс | $\approx 3.3 \times 10^8$ | 333 сек |
| Ленточный ($w=10$) | $\approx 1.5 \times 10^5$ | 0.15 сек |
| Трехдиагональный | $\approx 2000$ | 0.002 сек |


**Пример 7: Экспериментальная проверка**

Реализация метода Гаусса для ленточных матриц с различными $w$ и измерение числа выполненных операций:

| $n$ | $w$ | Теоретическое $P$ | Измеренное $P$ | Погрешность |
|-----|-----|------------------|----------------|-------------|
| 100 | 3 | 582 | 598 | +2.7% |
| 100 | 5 | 1640 | 1658 | +1.1% |
| 500 | 10 | 74730 | 74802 | +0.1% |
| 1000 | 20 | 526340 | 526480 | +0.03% |

Формула очень точно предсказывает реальное число операций для $w \geq 3$.


**Пример 8: Формула для обратной подстановки**

Для верхней треугольной ленточной матрицы число операций обратной подстановки:

$$
P_{\text{back}} = \sum_{i=1}^{n} \min(w+1, n-i+1) \approx n \cdot w
$$

Для $n = 1000$, $w = 10$: $P_{\text{back}} \approx 10000$ операций (в 15 раз меньше, чем прямой ход).


**Пример 9: Асимптотика при $w = \sqrt{n}$**

Пусть $w = \sqrt{n}$. Тогда:

$$
P \approx w^2 n = (\sqrt{n})^2 \cdot n = n^2
$$

Квадратичная сложность — промежуточная между линейной и кубической.

Для многомерных задач это типичная ситуация.

---

## Источник

- Документ: [[Линейная_алгебра_и_её_применения.pdf]]
- Раздел/страницы: § 1.6, стр. 57-59
- Ключевая цитата:
  
  > «Перечисленные упрощения приводят к полному пересмотру общего подсчета числа действий. Каждый шаг исключения требует будет только двух действий — деления на ведущий элемент и умножения-вычитания справа от ведущего элемента. Таких шагов исключения около $n$. Следовательно, **вместо $n^3/3$ действий требуется только $2n$**, т. е. объем вычислений является величиной меньшего порядка. То же самое справедливо для обратной подстановки — вместо $n^2/2$ действий опять требуется только $2n$... **число делений и умножений-вычитаний, требуемых для построения $L$, $D$ и $U$ (без предположения симметричности $A$), вычисляется по формуле $P = \frac{1}{3}w(w-1)(3n - 2w + 1)$.**»

---

## Вопросы

- Почему формула неточна для $w = 1$ и как её исправить?
- Как учесть в формуле операции с правой частью $b$?
- Существует ли аналогичная формула для разложения Холецкого?
- Как формула меняется при использовании частичного выбора ведущего элемента?
- Можно ли вывести формулу для блочно-ленточных матриц?