## Суть

**Частичный выбор ведущего элемента** (partial pivoting) — это стратегия в методе исключения Гаусса, при которой на каждом шаге $k$ в качестве ведущего элемента выбирается **максимальный по модулю** элемент из столбца $k$ среди строк с индексами $k, k+1, \ldots, n$.

Эта стратегия решает две проблемы:
1. **Избегает деления на нуль** (или очень малые числа);
2. **Улучшает численную устойчивость** метода, минимизируя ошибки округления.

Частичный выбор — это стандартная практика в численных реализациях метода Гаусса.

---

## Детали

### Определение

На $k$-м шаге исключения Гаусса **частичный выбор ведущего элемента** означает:

**Шаг 1**: Найти индекс $p \geq k$ такой, что:
$$
|a_{pk}^{(k-1)}| = \max_{i \geq k} |a_{ik}^{(k-1)}|
$$

где $a_{ij}^{(k-1)}$ — элементы матрицы после $(k-1)$ шагов исключения.

**Шаг 2**: Переставить строки $k$ и $p$ (если $p \neq k$):
$$
P_k A^{(k-1)} \quad \text{где } P_k \text{ меняет местами строки } k \text{ и } p
$$

**Шаг 3**: Выполнить исключение, используя $a_{kk}$ как ведущий элемент

### Зачем нужен частичный выбор?

**Проблема 1: Нулевой ведущий элемент**

Если $a_{kk} = 0$, деление на него невозможно. Частичный выбор гарантирует ненулевой ведущий (если матрица невырожденная).

**Проблема 2: Малый ведущий элемент**

Даже если $a_{kk} \neq 0$, но очень мал (например, $10^{-10}$), то множители исключения:
$$
l_{ik} = \frac{a_{ik}}{a_{kk}}
$$
будут **очень большими**, что приводит к катастрофическому накоплению ошибок округления.

**Пример**: Если $a_{kk} = 10^{-10}$ и $a_{ik} = 1$, то $l_{ik} = 10^{10}$ — огромное число!

### Полный выбор vs частичный выбор

**Частичный выбор** (partial pivoting):
- Ищет максимум только **в текущем столбце** (среди строк $\geq k$);
- Переставляет **только строки**.

**Полный выбор** (complete/full pivoting):
- Ищет максимум во **всей подматрице** (строки и столбцы $\geq k$);
- Переставляет **и строки, и столбцы**;
- Более стабилен, но **гораздо дороже** вычислительно.

**На практике**: частичный выбор — стандарт. Полный выбор используется редко (слишком дорого).

### Связь с PA-разложением

Частичный выбор ведущего элемента приводит к разложению:
$$
PA = LU
$$

где $P$ — матрица перестановки, учитывающая все перестановки строк в процессе исключения.

### Оценка множителей при частичном выборе

**Важное свойство**: При частичном выборе все множители исключения ограничены:
$$
|l_{ik}| \leq 1 \quad \text{для всех } i, k
$$

**Доказательство**: Так как $a_{kk}$ — максимальный по модулю в столбце, то:
$$
|l_{ik}| = \left|\frac{a_{ik}}{a_{kk}}\right| \leq \frac{|a_{kk}|}{|a_{kk}|} = 1
$$

Это **критически важно** для численной устойчивости!

### Алгоритм с частичным выбором

```

Для k = 1 до n-1:

# Найти максимальный элемент в столбце k

p = argmax_{i≥k} |a_{ik}|

# Переставить строки k и p

Если p ≠ k:

поменять местами строки k и p в A и в b

# Исключение

Для i = k+1 до n:

l_{ik} = a_{ik} / a_{kk}

Для j = k до n:

a_{ij} = a_{ij} - l_{ik} * a_{kj}

b_i = b_i - l_{ik} * b_k

```

---

## Примеры

### Пример: необходимость частичного выбора

Рассмотрим систему (в арифметике с 3 значащими цифрами):

$$

\begin{bmatrix}

0.0001 & 1 \\

1 & 1

\end{bmatrix}

\begin{bmatrix} x_1 \\ x_2 \end{bmatrix}

= \begin{bmatrix} 1 \\ 2 \end{bmatrix}

$$

**Без частичного выбора**:

Ведущий элемент $a_{11} = 0.0001$ (очень мал!)

Множитель: $l_{21} = \frac{1}{0.0001} = 10000$

Исключение:

$$

a_{22}^{new} = 1 - 10000 \cdot 1 = -9999

$$

$$

b_2^{new} = 2 - 10000 \cdot 1 = -9998

$$

Система стала:

$$

\begin{bmatrix}

0.0001 & 1 \\

0 & -9999

\end{bmatrix}

\begin{bmatrix} x_1 \\ x_2 \end{bmatrix}

= \begin{bmatrix} 1 \\ -9998 \end{bmatrix}

$$

Обратная подстановка:

- $x_2 = -9998 / -9999 \approx 1.00$ (в 3-значной арифметике);

- $x_1 = (1 - 1 \cdot 1.00) / 0.0001 = 0$ (!).

**Результат**: $x_1 = 0$, $x_2 = 1$

**Точное решение**: $x_1 \approx 1.0001$, $x_2 \approx 0.9999$

**Огромная ошибка** в $x_1$!

---

**С частичным выбором**:

Максимальный элемент в первом столбце: $|1| > |0.0001|$

Переставляем строки:

$$

\begin{bmatrix}

1 & 1 \\

0.0001 & 1

\end{bmatrix}

\begin{bmatrix} x_1 \\ x_2 \end{bmatrix}

= \begin{bmatrix} 2 \\ 1 \end{bmatrix}

$$

Множитель: $l_{21} = \frac{0.0001}{1} = 0.0001$ (мал!)

Исключение:

$$

a_{22}^{new} = 1 - 0.0001 \cdot 1 = 1.00 \text{ (в 3-значной)}

$$

$$

b_2^{new} = 1 - 0.0001 \cdot 2 = 1.00

$$

Обратная подстановка:

- $x_2 = 1.00 / 1.00 = 1.00$

- $x_1 = (2 - 1 \cdot 1.00) / 1 = 1.00$

**Результат**: $x_1 = 1.00$, $x_2 = 1.00$ — **гораздо точнее**!

### Пример из книги: матрица 3×3

$$

A = \begin{bmatrix}

1 & 2 & 3 \\

2 & 4 & 5 \\

4 & 5 & 6

\end{bmatrix}

$$

**Шаг 1**: Первый столбец: $|1| = 1$, $|2| = 2$, $|4| = 4$

Максимум: $a_{31} = 4$ → переставляем строки 1 и 3:

$$

\begin{bmatrix}

4 & 5 & 6 \\

2 & 4 & 5 \\

1 & 2 & 3

\end{bmatrix}

$$

Множители: $l_{21} = 2/4 = 0.5$, $l_{31} = 1/4 = 0.25$ (оба $\leq 1$ ✓)

После исключения:

$$

\begin{bmatrix}

4 & 5 & 6 \\

0 & 1.5 & 2 \\

0 & 0.75 & 1.5

\end{bmatrix}

$$

**Шаг 2**: Второй столбец (строки 2-3): $|1.5| > |0.75|$

Максимум: $a_{22} = 1.5$ → перестановка не нужна

Множитель: $l_{32} = 0.75/1.5 = 0.5$ (снова $\leq 1$ ✓)

Результат: устойчивое разложение с ограниченными множителями.

### Контрпример: когда частичный выбор не помогает

**Матрица Вилкинсона**:

$$

A = \begin{bmatrix}

1 & 0 & 0 & 0 & 1 \\

-1 & 1 & 0 & 0 & 1 \\

-1 & -1 & 1 & 0 & 1 \\

-1 & -1 & -1 & 1 & 1 \\

-1 & -1 & -1 & -1 & 1

\end{bmatrix}

$$

Даже с частичным выбором элементы матрицы $U$ могут расти **экспоненциально** ($\approx 2^{n-1}$).

Это **редкий** патологический случай — для большинства матриц частичный выбор работает отлично.

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]

- Раздел/страницы: § 1.5, стр. 39–43, 50–51

- Ключевая цитата:

> «Успешный выбор ведущего элемента требует теоретического изменения алгоритма исключения, очень маленький ведущий элемент требует его **практического** изменения. А именно, если он окажется равным нулю в точной арифметике... Какое количество арифметических операций требует метод исключения для решения системы $n$ уравнений с $n$ неизвестными?»

---

## Вопросы

- Почему полный выбор ведущего элемента редко используется на практике?

- Существуют ли матрицы, для которых частичный выбор не улучшает устойчивость?

- Как частичный выбор влияет на структуру матрицы перестановок $P$?

- Можно ли комбинировать частичный выбор с масштабированием строк для лучшей устойчивости?

- Как частичный выбор обобщается на блочные алгоритмы исключения?