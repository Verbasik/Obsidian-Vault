## Суть

**Полный выбор ведущего элемента** (complete/full pivoting) — это стратегия в методе исключения Гаусса, при которой на каждом шаге $k$ в качестве ведущего элемента выбирается **максимальный по модулю** элемент из **всей оставшейся подматрицы** (строки и столбцы с индексами $\geq k$).

В отличие от частичного выбора (только перестановки строк), полный выбор требует перестановок **и строк, и столбцов**. Это обеспечивает **наилучшую численную устойчивость**, но требует значительно больше вычислений для поиска максимума.

---

## Детали

### Определение

На $k$-м шаге исключения **полный выбор ведущего элемента** означает:

**Шаг 1**: Найти индексы $(p, q)$ с $p \geq k$ и $q \geq k$ такие, что:
$$
|a_{pq}^{(k-1)}| = \max_{i,j \geq k} |a_{ij}^{(k-1)}|
$$

**Шаг 2**: Переставить строки $k$ и $p$, затем столбцы $k$ и $q$:
$$
P_k A^{(k-1)} Q_k
$$
где $P_k$ — перестановка строк, $Q_k$ — перестановка столбцов

**Шаг 3**: Выполнить исключение с $a_{kk}$ как ведущим элементом

**Результат**: Разложение вида:
$$
PAQ = LU
$$
где $P$ — произведение всех перестановок строк, $Q$ — произведение всех перестановок столбцов.

### Отличия от частичного выбора

| Аспект | Частичный выбор | Полный выбор |
|--------|----------------|--------------|
| Область поиска | Только текущий столбец | Вся подматрица $(k:n, k:n)$ |
| Перестановки | Только строки | Строки **и** столбцы |
| Сложность поиска | $O(n-k)$ | $O((n-k)^2)$ |
| Стабильность | Хорошая | **Превосходная** |
| Разложение | $PA = LU$ | $PAQ = LU$ |

### Вычислительная сложность

**Поиск максимума на шаге $k$**:
- Частичный выбор: $(n-k)$ сравнений → $O(n)$ на шаг;
- Полный выбор: $(n-k)^2$ сравнений → $O(n^2)$ на шаг.

**Общая сложность поиска**:
- Частичный: $\sum_{k=1}^{n-1} (n-k) = O(n^2)$ — **пренебрежимо** по сравнению с $O(n^3)$ исключения;
- Полный: $\sum_{k=1}^{n-1} (n-k)^2 = O(n^3)$ — **сравнимо** с самим исключением!

**Вывод**: полный выбор **удваивает** время выполнения.

### Численная устойчивость

**Теорема** (Уилкинсон): При полном выборе рост элементов ограничен:
$$
|u_{ij}| \leq C \cdot \max |a_{ij}|
$$
где $C$ растёт **очень медленно** с $n$ (почти как $\sqrt{n}$).

Для частичного выбора в худшем случае $C \approx 2^{n-1}$ (экспоненциальный рост).

**На практике**: для подавляющего большинства матриц частичный выбор достаточен. Полный выбор используется только в критических приложениях.

### Влияние на решение

**Важно**: Перестановка столбцов **изменяет порядок неизвестных**!

Если $PAQ = LU$, то для решения $Ax = b$:

**Шаг 1**: $c = Pb$ (переставить правую часть);

**Шаг 2**: Решить $Ly = c$ (прямая подстановка);

**Шаг 3**: Решить $Uz = y$ (обратная подстановка);

**Шаг 4**: $x = Qz$ (переставить компоненты решения обратно!).

Пропуск шага 4 даст **неправильный порядок** компонент решения.

### Когда использовать полный выбор?

**Используйте полный выбор, если**:
1. Требуется **максимальная точность** (критические приложения);
2. Матрица **плохо обусловлена** (малые изменения данных → большие изменения решения);
3. Известно, что частичный выбор даёт неточные результаты.

**Не используйте, если**:
1. Скорость важнее точности;
2. Матрица хорошо обусловлена;
3. Размерность $n$ велика (стоимость поиска слишком высока).

---

## Примеры

### Пример: полный vs частичный выбор

$$
A = \begin{bmatrix}
1 & 2 & 100 \\
2 & 1 & 1 \\
1 & 1 & 1
\end{bmatrix}
$$

**Частичный выбор** (шаг 1):

Максимум в столбце 1: $|2|$ → переставить строки 1 и 2:
$$
\begin{bmatrix}
2 & 1 & 1 \\
1 & 2 & 100 \\
1 & 1 & 1
\end{bmatrix}
$$

Ведущий элемент: $a_{11} = 2$

**Полный выбор** (шаг 1):

Максимум во всей матрице: $|100|$ в позиции $(1, 3)$

Переставить строки $1 \leftrightarrow 1$ (без изменений), столбцы $1 \leftrightarrow 3$:
$$
\begin{bmatrix}
100 & 2 & 1 \\
1 & 1 & 2 \\
1 & 1 & 1
\end{bmatrix}
$$

Ведущий элемент: $a_{11} = 100$ — **намного больше**!

Множители исключения будут **намного меньше** (лучше для точности).

### Пример: влияние на порядок решения

Система после полного выбора с перестановкой столбцов $1 \leftrightarrow 3$:

Исходные неизвестные: $x_1, x_2, x_3$

После перестановки решаем для: $x_3, x_2, x_1$ (в этом порядке!)

Получили решение: $z = [z_1, z_2, z_3]^T$

**Правильное решение исходной системы**:
$$
x = Q z = \begin{bmatrix}
0 & 0 & 1 \\
0 & 1 & 0 \\
1 & 0 & 0
\end{bmatrix}
\begin{bmatrix} z_1 \\ z_2 \\ z_3 \end{bmatrix}
= \begin{bmatrix} z_3 \\ z_2 \\ z_1 \end{bmatrix}
$$

Забыть применить $Q$ — **типичная ошибка**!

### Патологический случай для частичного выбора

**Матрица**:
$$
A = \begin{bmatrix}
\epsilon & 1 & 1 \\
1 & 1 & 1 \\
1 & 1 & 1
\end{bmatrix}, \quad \epsilon \approx 10^{-10}
$$

**Частичный выбор**: Максимум в первом столбце — $|1|$, переставляем:
$$
\begin{bmatrix}
1 & 1 & 1 \\
\epsilon & 1 & 1 \\
1 & 1 & 1
\end{bmatrix}
$$

После исключения получим большие элементы в $U$ (нестабильно).

**Полный выбор**: Максимум во всей матрице — $|1|$ (много вариантов, выберем $(2,2)$).

Перестановки строк и столбцов приведут к лучше обусловленной системе.

---

## Источник

- Документ: [[Линейная алгебра и ее применения.pdf]]
- Раздел/страницы: § 1.5, стр. 50–51 (косвенное упоминание)
- Ключевая цитата:
  
  > «Некоторая свобода действий существует и имеется «алгоритм Кроута», который осуществляет вычисления в несколько другом порядке. Конечно, это не абсолютная свобода, так как операции, проводимые со строками, легко могут уничтожить на некотором шаге нули, которые были получены на одном из предыдущих шагов... И, **кроме того**, нет никакой свободы в выборе окончательных матриц $L$, $D$ и $U$».

**Примечание**: Полный выбор не описан подробно в доступных страницах книги Стренга, но является стандартной темой в численной линейной алгебре.

---

## Вопросы

- В каких ситуациях полный выбор критически необходим?
- Можно ли уменьшить стоимость поиска максимума в полном выборе?
- Как полный выбор влияет на разреженность матриц $L$ и $U$?
- Существуют ли гибридные стратегии между частичным и полным выбором?
- Как обобщается полный выбор на блочные алгоритмы?