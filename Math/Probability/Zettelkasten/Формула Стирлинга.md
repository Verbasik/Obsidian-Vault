## Суть

**Формула Стирлинга** даёт асимптотическое приближение факториала $n!$ при больших $n$ и является ключевым инструментом в асимптотическом анализе вероятностных распределений.  
Она позволяет получать точные приближённые оценки биномиальных коэффициентов и вероятностей.

Базовая форма:  
$$  
n! \sim \sqrt{2\pi n}\left(\frac{n}{e}\right)^n,\qquad n\to\infty.  
$$

---

## Детали

### Точная формулировка (с остатком)

Существует последовательность $\theta_n\in(0,1)$ такая, что  
$$  
n!

\sqrt{2\pi n}\left(\frac{n}{e}\right)^n  
\exp!\left(\frac{\theta_n}{12n}\right).  
$$

Отсюда следует контролируемая относительная погрешность порядка $O(1/n)$.

---

### Логарифмическая форма

Часто используется эквивалентная запись:  
$$  
\ln n! = n\ln n - n + \tfrac12\ln(2\pi n) + O!\left(\frac1n\right).  
$$

Она особенно удобна при выводе предельных распределений.

---

### Следствия

1. **Биномиальные коэффициенты**:  

$$  
    \binom{2n}{n}  
    =  
    \frac{(2n)!}{(n!)^2}  
    \sim \frac{4^n}{\sqrt{\pi n}}.  
$$

2. **Центральные члены биномиального распределения**:  

$$  
    P(X=n)\sim \frac{1}{\sqrt{\pi n}}\quad (p=\tfrac12).  
$$

3. **Экспоненциальный рост**:  
    факториал растёт быстрее любой экспоненты $a^n$, но медленнее $n^n$.

---

## Примеры

### Пример 1. Оценка $10!$

По формуле Стирлинга:  
$$  
10!\approx \sqrt{20\pi}\left(\frac{10}{e}\right)^{10}\approx 3.6\cdot10^6,  
$$  
что хорошо согласуется с точным значением $3,628,800$.

---

### Пример 2. Центральный биномиальный коэффициент

Для $n=100$:  
$$  
\binom{200}{100}\approx \frac{4^{100}}{\sqrt{100\pi}}.  
$$

---

### Пример 3. Асимптотика вероятности

В симметричной схеме Бернулли:  
$$  
P(X=n)\sim \frac{1}{\sqrt{\pi n}},  
$$  
что даёт порядок убывания максимальной вероятности.

---

### Пример 4. Контроль погрешности

Использование множителя $\exp(\theta_n/(12n))$ позволяет получать **строгие оценки** сверху и снизу.

---

### Пример 5. Вычислительная практика

При больших $n$ факториалы вычисляют через $\ln n!$ и формулу Стирлинга во избежание переполнения.

---

## Источник

- Документ: [[Вероятность.pdf]]
- Раздел: § 2, п. 4
- Страницы: 44
- Цитата:

> «Как с теоретической, так и с вычислительной точки зрения важна следующая формула Стирлинга…»

---

## Вопросы

1. В каком смысле формула Стирлинга является асимптотической?
2. Почему логарифмическая форма часто предпочтительнее?
3. Как использовать формулу Стирлинга для оценки биномиальных вероятностей?
4. Каков порядок относительной ошибки?
5. Почему формула критична для предельных теорем?