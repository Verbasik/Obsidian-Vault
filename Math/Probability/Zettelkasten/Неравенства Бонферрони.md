## Суть

**Неравенства Бонферрони** — это серия двусторонних оценок для вероятности объединения событий, полученных путём усечения формулы включений-исключений.

Для n событий $A_1, \ldots, A_n$ и любого чётного k: $$ S_1 - S_2 + S_3 - \cdots - S_k \leq P\left(\bigcup_{i=1}^n A_i\right) \leq S_1 - S_2 + \cdots + S_{k-1} $$

где $S_j$ — сумма вероятностей всех j-кратных пересечений.

Эти неравенства дают **улучшенные** оценки по сравнению с неравенством Буля.

---

## Детали

### Обозначения

Для событий $A_1, \ldots, A_n$ определим: $$ S_k = \sum_{1 \leq i_1 < \cdots < i_k \leq n} P(A_{i_1} \cap \cdots \cap A_{i_k}) $$

**Явно**:

- $S_1 = P(A_1) + \cdots + P(A_n)$;
- $S_2 = \sum_{i<j} P(A_i \cap A_j)$;
- $S_3 = \sum_{i<j<k} P(A_i \cap A_j \cap A_k)$;
- и так далее...

### Формула включений-исключений (точная)

$$ P\left(\bigcup_{i=1}^n A_i\right) = S_1 - S_2 + S_3 - S_4 + \cdots + (-1)^{n+1} S_n $$

### Неравенства Бонферрони (усечённые формулы)

**Для чётных k** ($k = 2m$): $$ S_1 - S_2 + \cdots - S_{2m} \leq P\left(\bigcup_{i=1}^n A_i\right) \leq S_1 - S_2 + \cdots + S_{2m-1} $$

**Для нечётных k** ($k = 2m+1$): $$ S_1 - S_2 + \cdots + S_{2m+1} \geq P\left(\bigcup_{i=1}^n A_i\right) \geq S_1 - S_2 + \cdots - S_{2m} $$

**Правило**:

- Если обрываем на плюсе → оценка **сверху**;
- Если обрываем на минусе → оценка **снизу**.

### Частные случаи

**k=1** (неравенство Буля): $$ P\left(\bigcup_{i=1}^n A_i\right) \leq S_1 = \sum_{i=1}^n P(A_i) $$

**k=2** (первое неравенство Бонферрони): $$ S_1 - S_2 \leq P\left(\bigcup_{i=1}^n A_i\right) \leq S_1 $$

Нижняя граница: $\sum P(A_i) - \sum_{i<j} P(A_i \cap A_j)$

**k=3**: $$ S_1 - S_2 \leq P\left(\bigcup_{i=1}^n A_i\right) \leq S_1 - S_2 + S_3 $$

### Качество оценок

Неравенства Бонферрони дают **тем более точные** оценки, чем больше k:

- При k=1: грубая оценка (неравенство Буля);
- При k=2: улучшенная двусторонняя оценка;
- При k→n: приближаемся к точному значению.

Компромисс: более точные оценки требуют вычисления большего числа пересечений.

---

## Примеры

**Пример 1**: Три события на кости

$A_1 = {1, 2}$, $A_2 = {2, 3}$, $A_3 = {3, 4}$

$P(A_i) = 1/3$ для всех i

Пересечения:

- $S_1 = 3 \cdot (1/3) = 1$
- $A_1 A_2 = {2}$, $P = 1/6$
- $A_1 A_3 = \emptyset$, $P = 0$
- $A_2 A_3 = {3}$, $P = 1/6$
- $S_2 = 1/6 + 0 + 1/6 = 1/3$
- $S_3 = 0$

Точное значение: $P(A_1 \cup A_2 \cup A_3) = 4/6 = 2/3$

**Оценки**:

k=1 (Буль): $P \leq S_1 = 1$

k=2 (Бонферрони): $S_1 - S_2 \leq P \leq S_1$ $$ 1 - \frac{1}{3} \leq P \leq 1 $$ $$ \frac{2}{3} \leq P \leq 1 $$

Точное значение $P = 2/3$ попало в интервал! Более того, нижняя граница точная.


**Пример 2**: Двукратное подбрасывание монеты

$A$ = «первый бросок Г» = ${ГГ, ГР}$

$B$ = «второй бросок Г» = ${ГГ, РГ}$

$P(A) = P(B) = 1/2$

$A \cap B = {ГГ}$, $P(AB) = 1/4$

Точное: $P(A \cup B) = P(A) + P(B) - P(AB) = 1/2 + 1/2 - 1/4 = 3/4$

**Оценки**:

k=1: $P \leq 1/2 + 1/2 = 1$ (грубо)

k=2: $1/2 + 1/2 - 1/4 \leq P \leq 1/2 + 1/2$ $$ 3/4 \leq P \leq 1 $$

Нижняя граница **точная**: $P = 3/4$ ✓


**Пример 3**: Четыре редких события

События $A_1, \ldots, A_4$ с малыми вероятностями и редкими пересечениями.

$P(A_i) = 0.01$ для всех i

$P(A_i \cap A_j) = 0.0001$ для всех пар

Остальные пересечения пренебрежимо малы.

$S_1 = 4 \cdot 0.01 = 0.04$

$S_2 = \binom{4}{2} \cdot 0.0001 = 6 \cdot 0.0001 = 0.0006$

**k=2 (Бонферрони)**: $$ 0.04 - 0.0006 \leq P \leq 0.04 $$ $$ 0.0394 \leq P \leq 0.04 $$

Очень узкий интервал! Практически точное значение.

---

## Источник

- Документ: [[Вероятность.pdf]]
- Раздел/страницы: § 1, Задача 5(a), стр. 37-38
- Ключевая цитата:
    > «Доказать справедливость следующих свойств: (a) неравенства Бонферрони: для всякого $k = 1, 2, \ldots$ такого, что $2k \leq n$, $S_1 - S_2 + ... - S_{2k} \leq P(\bigcup_{i=1}^n A_i) \leq S_1 - S_2 + ... + S_{2k-1}$».

---

## Вопросы

- Когда стоит использовать неравенства Бонферрони вместо неравенства Буля?
- Сколько членов k нужно брать для хорошей оценки?
- Всегда ли неравенства Бонферрони точнее неравенства Буля?
- Как оценить погрешность при усечении на k членах?